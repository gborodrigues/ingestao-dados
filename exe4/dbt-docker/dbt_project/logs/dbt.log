

============================== 2024-08-25 14:17:24.127373 | 8af6d71a-5810-4eb1-b592-334a8bcd7655 ==============================
[0m14:17:24.127384 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:17:24.127661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:17:24.127796 [debug] [MainThread]: Tracking: tracking
[0m14:17:24.129437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8fca0>]}
[0m14:17:24.131659 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jpeks6wz'
[0m14:17:24.131932 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:17:24.211992 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:17:24.212452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:17:24.282666 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:17:24.340096 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:17:24.663384 [info ] [MainThread]:   Installed from version 1.0.0
[0m14:17:24.663660 [info ] [MainThread]:   Updated version available: 1.2.0
[0m14:17:24.664050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8af6d71a-5810-4eb1-b592-334a8bcd7655', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8f220>]}
[0m14:17:24.664347 [info ] [MainThread]: 
[0m14:17:24.664631 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:17:24.665227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184cf8fb20>]}
[0m14:17:24.665415 [debug] [MainThread]: Flushing usage events


============================== 2024-08-25 14:17:27.444248 | da42b520-139e-44b9-8c90-059580bc00a0 ==============================
[0m14:17:27.444260 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:17:27.444528 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m14:17:27.444660 [debug] [MainThread]: Tracking: tracking
[0m14:17:27.446218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18e04580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18e04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18e04610>]}
[0m14:17:27.462915 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m14:17:27.463160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18e056c0>]}
[0m14:17:27.485593 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m14:17:27.489102 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:17:27.491414 [debug] [MainThread]: Parsing macros/relations.sql
[0m14:17:27.492740 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:17:27.516313 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:17:27.517559 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:17:27.524438 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:17:27.526092 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:17:27.526849 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:17:27.527285 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:17:27.528368 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m14:17:27.529399 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m14:17:27.531063 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:17:27.533498 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:17:27.537206 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:17:27.552130 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:17:27.566321 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:17:27.569161 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:17:27.573642 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:17:27.583149 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:17:27.585293 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:17:27.592020 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:17:27.600597 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:17:27.605863 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:17:27.606935 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:17:27.607952 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:17:27.608954 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:17:27.610767 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:17:27.611643 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:17:27.612629 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:17:27.613659 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:17:27.614742 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:17:27.615527 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:17:27.616507 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:17:27.617497 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:17:27.618660 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:17:27.619644 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:17:27.622051 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:17:27.623299 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:17:27.624161 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:17:27.625354 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:17:27.626332 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:17:27.627186 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:17:27.633562 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:17:27.634524 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:17:27.636621 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:17:27.637496 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:17:27.638992 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:17:27.639930 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:17:27.640592 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:17:27.641938 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:17:27.642695 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:17:27.646428 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:17:27.648634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:17:27.650425 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:17:27.661985 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:17:27.681884 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:17:27.694614 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:17:27.702025 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:17:27.720042 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:17:27.722626 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:17:27.728168 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:17:27.731550 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:17:27.733008 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:17:27.738446 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:17:27.742037 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:17:27.750204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:17:27.751744 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:17:27.766516 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:17:27.782800 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:17:27.789629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:17:27.800279 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:17:27.805006 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:17:27.806810 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:17:27.808607 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:17:27.810092 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:17:27.812448 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:17:27.813963 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:17:27.820032 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:17:27.822999 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:17:27.825017 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:17:27.826489 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:17:27.828980 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:17:27.830416 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:17:27.834897 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m14:17:27.836004 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:17:27.839305 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:17:27.843567 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:17:27.845791 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:17:27.852252 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:17:27.854716 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:17:27.867809 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:17:27.872145 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:17:27.878096 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:17:27.879496 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:17:27.885626 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m14:17:27.888591 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:17:27.890288 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:17:27.896278 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:17:27.899993 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:17:27.901583 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:17:27.907244 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:17:27.908709 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m14:17:27.913733 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:17:27.915499 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:17:27.918341 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:17:27.921595 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m14:17:27.924211 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:17:27.926486 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:17:27.935426 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:17:27.937586 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m14:17:27.939283 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:17:27.941368 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:17:27.943672 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:17:27.946876 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:17:27.948845 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:17:27.951659 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:17:27.956019 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:17:27.958421 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:17:27.961877 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:17:27.963738 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:17:27.967269 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:17:27.971609 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:17:27.976027 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:17:27.977591 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:17:27.978864 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:17:27.979908 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:17:27.981085 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m14:17:27.982901 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m14:17:28.352533 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m14:17:28.364483 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m14:17:28.366999 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m14:17:28.369770 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m14:17:28.433572 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m14:17:28.479558 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m14:17:28.556944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18dbbac0>]}
[0m14:17:28.566702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18dbbb50>]}
[0m14:17:28.566962 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m14:17:28.567149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18dba2c0>]}
[0m14:17:28.568719 [info ] [MainThread]: 
[0m14:17:28.569311 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:17:28.570595 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m14:17:28.581965 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:17:28.582141 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:17:28.582227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:28.586188 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:17:28.587320 [debug] [ThreadPool]: On list_postgres: Close
[0m14:17:28.589042 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m14:17:28.594893 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m14:17:28.595054 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m14:17:28.595137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:28.597877 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:17:28.598014 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m14:17:28.598093 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:17:28.600314 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.0 seconds
[0m14:17:28.601990 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m14:17:28.602249 [debug] [ThreadPool]: On list_postgres_public: Close
[0m14:17:28.607595 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:28.607773 [debug] [MainThread]: On master: BEGIN
[0m14:17:28.607855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:28.610731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:28.610921 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:28.611002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:28.617314 [debug] [MainThread]: SQL status: SELECT 43 in 0.01 seconds
[0m14:17:28.620336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1756da80>]}
[0m14:17:28.620583 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:28.620846 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:28.620936 [debug] [MainThread]: On master: BEGIN
[0m14:17:28.621304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:28.621407 [debug] [MainThread]: On master: COMMIT
[0m14:17:28.621535 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:28.621616 [debug] [MainThread]: On master: COMMIT
[0m14:17:28.621900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:28.622017 [debug] [MainThread]: On master: Close
[0m14:17:28.622731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:28.622947 [info ] [MainThread]: 
[0m14:17:28.637880 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m14:17:28.638166 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m14:17:28.638690 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.638797 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m14:17:28.638894 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m14:17:28.641843 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m14:17:28.643652 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:28.643799 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m14:17:28.682753 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m14:17:28.684535 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.684690 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m14:17:28.684773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:28.687641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:28.687867 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.687953 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m14:17:28.690052 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:28.696138 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.696312 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m14:17:28.696750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:28.713786 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m14:17:28.713968 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.714052 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m14:17:28.717118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:28.722126 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m14:17:28.722283 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m14:17:28.722606 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:28.723729 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:28.723860 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m14:17:28.724455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd15b01f00>]}
[0m14:17:28.724871 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m14:17:28.725259 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m14:17:28.725474 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:17:28.725702 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m14:17:28.726612 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m14:17:28.726854 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:17:28.727266 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:28.727450 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:17:28.817253 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m14:17:28.817446 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:17:28.817531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:28.820343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:28.820594 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m14:17:28.820727 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */

    create table "postgres"."public"."customer_base" ("customer_id" integer,"store_id" integer,"first_name" text,"last_name" text,"email" text,"address_id" integer,"activebool" text,"create_date" date,"last_update" timestamp without time zone,"active" integer)
  
[0m14:17:28.827980 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.01 seconds
[0m14:17:30.073920 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m14:17:30.074154 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m14:17:30.088318 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.01 seconds
[0m14:17:30.094922 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:17:30.100941 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:17:30.101129 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m14:17:30.101215 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:17:30.104358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.104823 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.104972 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:17:30.105485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd15b87a00>]}
[0m14:17:30.105675 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.38s]
[0m14:17:30.106011 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:17:30.106227 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:17:30.106382 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_payment_customer_id ............................ [RUN]
[0m14:17:30.107402 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m14:17:30.107597 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:17:30.107907 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:17:30.122194 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m14:17:30.122968 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.123092 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:17:30.138553 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m14:17:30.139507 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m14:17:30.139607 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m14:17:30.139688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.142334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.142516 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m14:17:30.142601 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m14:17:30.144647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.146556 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.146760 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m14:17:30.147070 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m14:17:30.147615 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_payment_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m14:17:30.147992 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:17:30.148245 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:17:30.148405 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_payment_payment_id ............................. [RUN]
[0m14:17:30.149020 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m14:17:30.149131 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:17:30.149227 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:17:30.153900 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m14:17:30.154279 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.154389 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:17:30.156544 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m14:17:30.156760 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m14:17:30.156846 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m14:17:30.156922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.159768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.159961 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m14:17:30.160044 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m14:17:30.161497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.162728 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.162946 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m14:17:30.163228 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m14:17:30.163750 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_payment_payment_id ................................... [[32mPASS[0m in 0.01s]
[0m14:17:30.164056 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:17:30.164210 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:17:30.164456 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_payment_payment_id ............................... [RUN]
[0m14:17:30.164911 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m14:17:30.165051 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:17:30.165170 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:17:30.172080 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m14:17:30.172419 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.172539 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:17:30.174959 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m14:17:30.175270 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m14:17:30.175357 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m14:17:30.175434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.178560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.178794 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m14:17:30.178880 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:30.188131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m14:17:30.189575 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.189780 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m14:17:30.190167 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m14:17:30.190930 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_payment_payment_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:17:30.191419 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:17:30.191609 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:17:30.192005 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m14:17:30.193137 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:17:30.193300 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:17:30.193538 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:17:30.198700 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:17:30.199992 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.200146 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:17:30.203046 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:17:30.203871 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:17:30.203985 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m14:17:30.204065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.206774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.206987 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:17:30.207075 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m14:17:30.207894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.209087 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.209256 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m14:17:30.209622 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m14:17:30.210342 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m14:17:30.210757 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:17:30.210956 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:17:30.211171 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m14:17:30.211850 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:17:30.211961 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:17:30.212058 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:17:30.217334 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:17:30.217639 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.217748 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:17:30.220161 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:17:30.220457 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:17:30.220545 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m14:17:30.220622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.223957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.224181 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:17:30.224264 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m14:17:30.225031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.226205 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.226354 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m14:17:30.226706 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m14:17:30.227365 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.02s]
[0m14:17:30.227710 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:17:30.227879 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:17:30.228296 [info ] [Thread-1 (]: 8 of 14 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m14:17:30.229086 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.229247 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m14:17:30.229349 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m14:17:30.232131 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.232846 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.232966 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m14:17:30.238970 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.240063 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.240209 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m14:17:30.240323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.243709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.243953 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.244049 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m14:17:30.245533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:30.248170 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.248338 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m14:17:30.248806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:30.250100 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m14:17:30.250213 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.250324 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m14:17:30.253050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.255350 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m14:17:30.255513 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m14:17:30.255923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:30.256859 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.256979 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m14:17:30.257504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd15b2e380>]}
[0m14:17:30.257766 [info ] [Thread-1 (]: 8 of 14 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.03s]
[0m14:17:30.258116 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:17:30.258323 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:17:30.258538 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m14:17:30.259321 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.259440 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:17:30.259539 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m14:17:30.262361 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.262700 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.262811 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:17:30.268913 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.269250 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.269344 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:17:30.269424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.272336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.272550 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.272643 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m14:17:30.274177 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:30.276885 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.277032 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m14:17:30.277549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:30.278882 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:17:30.279006 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.279105 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:17:30.283897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.286155 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m14:17:30.286310 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m14:17:30.286799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:30.287877 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.288044 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:17:30.288578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd140cde10>]}
[0m14:17:30.288853 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.03s]
[0m14:17:30.289212 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:17:30.289386 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:17:30.289883 [info ] [Thread-1 (]: 10 of 14 START sql table model public.cumulative_revenue ....................... [RUN]
[0m14:17:30.290736 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.290929 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m14:17:30.291034 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m14:17:30.294594 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.295300 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.295408 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m14:17:30.319018 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.319793 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.319897 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m14:17:30.320019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.322902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.323135 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.323226 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m14:17:30.336567 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.01 seconds
[0m14:17:30.339389 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.339568 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m14:17:30.340091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:30.341636 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m14:17:30.341773 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.341856 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m14:17:30.344653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.346967 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m14:17:30.347127 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m14:17:30.347518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:17:30.348491 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.348641 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m14:17:30.349282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd15b0d9f0>]}
[0m14:17:30.349658 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.06s]
[0m14:17:30.350144 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:17:30.350360 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:17:30.350668 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m14:17:30.351266 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:17:30.351447 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:17:30.351608 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:17:30.358170 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:17:30.358923 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.359062 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:17:30.361462 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:17:30.362240 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:17:30.362343 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:17:30.362422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.365425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.365654 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:17:30.365823 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m14:17:30.366943 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.368218 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.368367 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:17:30.368656 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:17:30.369177 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.02s]
[0m14:17:30.369561 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:17:30.369780 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:17:30.369953 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m14:17:30.370676 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:17:30.370806 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:17:30.370904 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:17:30.375097 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:17:30.375463 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.375611 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:17:30.378250 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:17:30.378568 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:17:30.378657 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:17:30.378736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.381569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.381778 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:17:30.381863 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m14:17:30.383838 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.385102 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.385234 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:17:30.385478 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:17:30.386037 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.02s]
[0m14:17:30.386419 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:17:30.386615 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:17:30.386932 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m14:17:30.387647 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:17:30.387833 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:17:30.387991 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:17:30.392348 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:17:30.392693 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.392806 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:17:30.395001 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:17:30.395316 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:17:30.395417 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:17:30.395497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.398571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.398770 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:17:30.398853 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:17:30.399989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:17:30.401215 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.401402 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:17:30.401802 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:17:30.402682 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.02s]
[0m14:17:30.403264 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:17:30.404249 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:17:30.404465 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m14:17:30.404991 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:17:30.405099 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:17:30.405196 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:17:30.409195 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.409406 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:17:30.471906 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:17:30.472949 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:17:30.473057 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:17:30.473145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:30.476156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.476467 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:17:30.476597 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      
  
    

  create  table "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"

    ) sbq



  );
  
  
[0m14:17:30.486411 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m14:17:30.488493 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:17:30.488656 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:17:30.488740 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:17:30.491383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.491869 [debug] [Thread-1 (]: finished collecting timing info
[0m14:17:30.491989 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:17:30.492516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da42b520-139e-44b9-8c90-059580bc00a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd17596bc0>]}
[0m14:17:30.492872 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSELECT 2[0m in 0.09s]
[0m14:17:30.493225 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:17:30.495049 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:17:30.495361 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:30.495506 [debug] [MainThread]: On master: BEGIN
[0m14:17:30.495637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:30.498926 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:30.499156 [debug] [MainThread]: On master: COMMIT
[0m14:17:30.499246 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:30.499326 [debug] [MainThread]: On master: COMMIT
[0m14:17:30.499534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:30.499637 [debug] [MainThread]: On master: Close
[0m14:17:30.500231 [info ] [MainThread]: 
[0m14:17:30.500410 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m14:17:30.500611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:30.500711 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:17:30.509922 [info ] [MainThread]: 
[0m14:17:30.510217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:30.510439 [info ] [MainThread]: 
[0m14:17:30.510600 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m14:17:30.510967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18db9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18dba170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd17597370>]}
[0m14:17:30.511192 [debug] [MainThread]: Flushing usage events
[0m14:26:46.466008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2159bf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2160ad1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2160ae7d0>]}


============================== 14:26:46.471551 | 73d5dab8-8374-45eb-ace5-a144356f6538 ==============================
[0m14:26:46.471551 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:26:46.472126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/dbt/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:46.579375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73d5dab8-8374-45eb-ace5-a144356f6538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc214826170>]}
[0m14:26:46.581619 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o642cx2i'
[0m14:26:46.582616 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:26:47.146447 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:26:47.147229 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:26:47.503735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:26:47.513973 [info ] [MainThread]: Updating lock file in file path: /usr/src/dbt/dbt_project/package-lock.yml
[0m14:26:47.525441 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iw73nb8j'
[0m14:26:47.530161 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:26:47.837139 [info ] [MainThread]: Installed from version 1.0.0
[0m14:26:47.837662 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:26:47.838079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '73d5dab8-8374-45eb-ace5-a144356f6538', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213eb6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2160ae860>]}
[0m14:26:47.838519 [info ] [MainThread]: 
[0m14:26:47.838867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:26:47.839943 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4227014, "process_user_time": 2.676291, "process_kernel_time": 0.190363, "process_mem_max_rss": "92620", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:26:47.840637 [debug] [MainThread]: Command `dbt deps` succeeded at 14:26:47.840517 after 1.42 seconds
[0m14:26:47.840989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2159bf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2160c8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc213f29f60>]}
[0m14:26:47.841373 [debug] [MainThread]: Flushing usage events
[0m14:26:51.221744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f139343d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13918fa7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13918fa0b0>]}


============================== 14:26:51.225334 | 02e244ee-afe0-478c-abcd-545ddb19cd7c ==============================
[0m14:26:51.225334 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:26:51.226258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'profiles_dir': 'profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir profiles', 'send_anonymous_usage_stats': 'True'}
[0m14:26:51.394198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e244ee-afe0-478c-abcd-545ddb19cd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13918fb2b0>]}
[0m14:26:51.467171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e244ee-afe0-478c-abcd-545ddb19cd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1390789de0>]}
[0m14:26:51.467959 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:26:51.481986 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:26:51.491047 [debug] [MainThread]: Failed to load parsed file from disk at /usr/src/dbt/dbt_project/target/partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[AnalysisNode, SingularTestNode, HookNode, ModelNode, RPCNode, SqlNode, GenericTestNode, SnapshotNode, SeedNode]] in Manifest has invalid value {'model.test_dbt_project.stg_payment': {'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.test_dbt_project.public.payment']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'staging', 'stg_payment'], 'unique_id': 'model.test_dbt_project.stg_payment', 'raw_code': "SELECT\n    *\nFROM\n    {{ source('public', 'payment') }}", 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'staging/stg_payment.sql', 'original_file_path': 'models/staging/stg_payment.sql', 'name': 'stg_payment', 'alias': 'stg_payment', 'checksum': {'name': 'sha256', 'checksum': 'b12c51ff786767ef385eb123701c48664cdbec4c168e75c477f568e89f3b8bee'}, 'tags': [], 'refs': [], 'sources': [['public', 'payment']], 'metrics': [], 'description': 'Staging model consisting of payment events', 'columns': {'payment_id': {'name': 'payment_id', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'customer_id': {'name': 'customer_id', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'test_dbt_project://models/staging/_staging_models.yml', 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4523222, 'config_call_dict': {}}, 'model.test_dbt_project.int_revenue_by_date': {'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.test_dbt_project.stg_payment']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'intermediate', 'int_revenue_by_date'], 'unique_id': 'model.test_dbt_project.int_revenue_by_date', 'raw_code': "SELECT\n    DATE(payment_date) AS payment_date,\n    SUM(amount) AS amount\nFROM\n    {{ ref('stg_payment') }}\nGROUP BY\n    1", 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'intermediate/int_revenue_by_date.sql', 'original_file_path': 'models/intermediate/int_revenue_by_date.sql', 'name': 'int_revenue_by_date', 'alias': 'int_revenue_by_date', 'checksum': {'name': 'sha256', 'checksum': '2cb72bd9fddb2e1b2fd60685216d568ac9aac21c51b5d2af65946afa4e3dc079'}, 'tags': [], 'refs': [['stg_payment']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'test_dbt_project://models/intermediate/_intermediate_models.yml', 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.469105, 'config_call_dict': {}}, 'model.test_dbt_project.int_customers_per_store': {'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['seed.test_dbt_project.customer_base']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'intermediate', 'int_customers_per_store'], 'unique_id': 'model.test_dbt_project.int_customers_per_store', 'raw_code': "SELECT\n    store_id,\n    COUNT(*) AS total_customers\nFROM\n    {{ ref('customer_base') }}\nGROUP BY\n    1", 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'intermediate/int_customers_per_store.sql', 'original_file_path': 'models/intermediate/int_customers_per_store.sql', 'name': 'int_customers_per_store', 'alias': 'int_customers_per_store', 'checksum': {'name': 'sha256', 'checksum': '34b78db8ef87eb6d3f71ab701772abf2e096b059394d62fe5e55e0e97a3e033a'}, 'tags': [], 'refs': [['customer_base']], 'sources': [], 'metrics': [], 'description': '', 'columns': {'store_id': {'name': 'store_id', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'total_customers': {'name': 'total_customers', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'test_dbt_project://models/intermediate/_intermediate_models.yml', 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.470986, 'config_call_dict': {}}, 'model.test_dbt_project.cumulative_revenue': {'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.test_dbt_project.int_revenue_by_date']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'marts', 'cumulative_revenue'], 'unique_id': 'model.test_dbt_project.cumulative_revenue', 'raw_code': "{{\n    config(\n        materialized='table',\n    )\n}}\n\nSELECT\n    payment_date,\n    amount,\n    SUM(amount) OVER (ORDER BY payment_date)\nFROM\n    {{ ref('int_revenue_by_date') }}\nORDER BY\n    payment_date", 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'marts/cumulative_revenue.sql', 'original_file_path': 'models/marts/cumulative_revenue.sql', 'name': 'cumulative_revenue', 'alias': 'cumulative_revenue', 'checksum': {'name': 'sha256', 'checksum': '3fb7264c704b513573c8ca3772ddc17779a95b1f02c8797abecde62560690a22'}, 'tags': [], 'refs': [['int_revenue_by_date']], 'sources': [], 'metrics': [], 'description': 'Cumulative revenue from sales', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'test_dbt_project://models/marts/_mart_models.yml', 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1724595448.478996, 'config_call_dict': {'materialized': 'table'}}, 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot': {'resource_type': 'snapshot', 'depends_on': {'macros': [], 'nodes': ['model.test_dbt_project.int_customers_per_store']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'snapshot', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': 'store_id', 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'strategy': 'check', 'target_schema': 'public', 'target_database': None, 'updated_at': None, 'check_cols': ['total_customers'], 'invalidate_hard_deletes': True, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'int_customers_per_store_snapshot', 'int_stock_balances_daily_grouped_by_day_snapshot'], 'unique_id': 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot', 'raw_code': "\n\n    {{\n        config(\n          target_schema='public',\n          strategy='check',\n          check_cols=['total_customers'],\n          unique_key='store_id',\n          invalidate_hard_deletes=True\n        )\n    }}\n\n    SELECT\n        store_id,\n        total_customers,\n        CURRENT_DATE\n    FROM\n        {{ ref('int_customers_per_store') }}\n\n", 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'int_customers_per_store_snapshot.sql', 'original_file_path': 'snapshots/int_customers_per_store_snapshot.sql', 'name': 'int_stock_balances_daily_grouped_by_day_snapshot', 'alias': 'int_stock_balances_daily_grouped_by_day_snapshot', 'checksum': {'name': 'sha256', 'checksum': 'e0da24575ec7f7e6683f8e568c0cb1dedd7817b91d050e392721e0b4f41d12cb'}, 'tags': [], 'refs': [['int_customers_per_store']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'target_schema': 'public', 'strategy': 'check', 'check_cols': ['total_customers'], 'unique_key': 'store_id', 'invalidate_hard_deletes': True}, 'created_at': 1724595448.3849323, 'config_call_dict': {'target_schema': 'public', 'strategy': 'check', 'check_cols': ['total_customers'], 'unique_key': 'store_id', 'invalidate_hard_deletes': True}}, 'seed.test_dbt_project.customer_base': {'resource_type': 'seed', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'seed', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'database': 'postgres', 'schema': 'public', 'fqn': ['test_dbt_project', 'customer_base'], 'unique_id': 'seed.test_dbt_project.customer_base', 'raw_code': '', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'customer_base.csv', 'original_file_path': 'seeds/customer_base.csv', 'name': 'customer_base', 'alias': 'customer_base', 'checksum': {'name': 'sha256', 'checksum': 'c1824045c42ffe3cd2a63987e057e741d4f64ae4c1793199a1c71577adb1e0b1'}, 'tags': [], 'refs': [], 'sources': [], 'metrics': [], 'description': 'Customer base stored as csv file', 'columns': {'customer_id': {'name': 'customer_id', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, 'store_id': {'name': 'store_id', 'description': '', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'test_dbt_project://seeds/_seeds.yml', 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4464555, 'config_call_dict': {}}, 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'total_customers', 'model': "{{ get_where_subquery(ref('int_customers_per_store_snapshot')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': []}, 'config': {'enabled': False, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'not_null_int_customers_per_store_snapshot_total_customers'], 'unique_id': 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_int_customers_per_store_snapshot_total_customers.sql', 'original_file_path': 'snapshots/_snapshots.yml', 'name': 'not_null_int_customers_per_store_snapshot_total_customers', 'alias': 'not_null_int_customers_per_store_snapshot_total_customers', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['int_customers_per_store_snapshot']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.443442, 'config_call_dict': {}, 'column_name': 'total_customers', 'file_key_name': 'snapshots.int_customers_per_store_snapshot'}, 'test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('customer_base')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['seed.test_dbt_project.customer_base']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'not_null_customer_base_customer_id'], 'unique_id': 'test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_customer_base_customer_id.sql', 'original_file_path': 'seeds/_seeds.yml', 'name': 'not_null_customer_base_customer_id', 'alias': 'not_null_customer_base_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['customer_base']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.447664, 'config_call_dict': {}, 'column_name': 'customer_id', 'file_key_name': 'seeds.customer_base'}, 'test.test_dbt_project.not_null_customer_base_store_id.e159464168': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'store_id', 'model': "{{ get_where_subquery(ref('customer_base')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['seed.test_dbt_project.customer_base']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'not_null_customer_base_store_id'], 'unique_id': 'test.test_dbt_project.not_null_customer_base_store_id.e159464168', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_customer_base_store_id.sql', 'original_file_path': 'seeds/_seeds.yml', 'name': 'not_null_customer_base_store_id', 'alias': 'not_null_customer_base_store_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['customer_base']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4496999, 'config_call_dict': {}, 'column_name': 'store_id', 'file_key_name': 'seeds.customer_base'}, 'test.test_dbt_project.unique_stg_payment_payment_id.7398e70184': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'payment_id', 'model': "{{ get_where_subquery(ref('stg_payment')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.test_dbt_project.stg_payment']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'staging', 'unique_stg_payment_payment_id'], 'unique_id': 'test.test_dbt_project.unique_stg_payment_payment_id.7398e70184', 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'unique_stg_payment_payment_id.sql', 'original_file_path': 'models/staging/_staging_models.yml', 'name': 'unique_stg_payment_payment_id', 'alias': 'unique_stg_payment_payment_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['stg_payment']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4533176, 'config_call_dict': {}, 'column_name': 'payment_id', 'file_key_name': 'models.stg_payment'}, 'test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'payment_id', 'model': "{{ get_where_subquery(ref('stg_payment')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.test_dbt_project.stg_payment']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'staging', 'not_null_stg_payment_payment_id'], 'unique_id': 'test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_stg_payment_payment_id.sql', 'original_file_path': 'models/staging/_staging_models.yml', 'name': 'not_null_stg_payment_payment_id', 'alias': 'not_null_stg_payment_payment_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['stg_payment']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.455442, 'config_call_dict': {}, 'column_name': 'payment_id', 'file_key_name': 'models.stg_payment'}, 'test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'customer_id', 'model': "{{ get_where_subquery(ref('stg_payment')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.test_dbt_project.stg_payment']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'staging', 'not_null_stg_payment_customer_id'], 'unique_id': 'test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_stg_payment_customer_id.sql', 'original_file_path': 'models/staging/_staging_models.yml', 'name': 'not_null_stg_payment_customer_id', 'alias': 'not_null_stg_payment_customer_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['stg_payment']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4575586, 'config_call_dict': {}, 'column_name': 'customer_id', 'file_key_name': 'models.stg_payment'}, 'test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d': {'test_metadata': {'name': 'unique', 'kwargs': {'column_name': 'store_id', 'model': "{{ get_where_subquery(ref('int_customers_per_store')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_unique'], 'nodes': ['model.test_dbt_project.int_customers_per_store']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'intermediate', 'unique_int_customers_per_store_store_id'], 'unique_id': 'test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d', 'raw_code': '{{ test_unique(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'unique_int_customers_per_store_store_id.sql', 'original_file_path': 'models/intermediate/_intermediate_models.yml', 'name': 'unique_int_customers_per_store_store_id', 'alias': 'unique_int_customers_per_store_store_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['int_customers_per_store']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4720445, 'config_call_dict': {}, 'column_name': 'store_id', 'file_key_name': 'models.int_customers_per_store'}, 'test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'store_id', 'model': "{{ get_where_subquery(ref('int_customers_per_store')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.test_dbt_project.int_customers_per_store']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'intermediate', 'not_null_int_customers_per_store_store_id'], 'unique_id': 'test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_int_customers_per_store_store_id.sql', 'original_file_path': 'models/intermediate/_intermediate_models.yml', 'name': 'not_null_int_customers_per_store_store_id', 'alias': 'not_null_int_customers_per_store_store_id', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['int_customers_per_store']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.474502, 'config_call_dict': {}, 'column_name': 'store_id', 'file_key_name': 'models.int_customers_per_store'}, 'test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': 'total_customers', 'model': "{{ get_where_subquery(ref('int_customers_per_store')) }}"}, 'namespace': None}, 'resource_type': 'test', 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.test_dbt_project.int_customers_per_store']}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'database': 'postgres', 'schema': 'public_dbt_test__audit', 'fqn': ['test_dbt_project', 'intermediate', 'not_null_int_customers_per_store_total_customers'], 'unique_id': 'test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc', 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'package_name': 'test_dbt_project', 'root_path': '/usr/src/dbt/dbt_project', 'path': 'not_null_int_customers_per_store_total_customers.sql', 'original_file_path': 'models/intermediate/_intermediate_models.yml', 'name': 'not_null_int_customers_per_store_total_customers', 'alias': 'not_null_int_customers_per_store_total_customers', 'checksum': {'name': 'none', 'checksum': ''}, 'tags': [], 'refs': [['int_customers_per_store']], 'sources': [], 'metrics': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1724595448.4767833, 'config_call_dict': {}, 'column_name': 'total_customers', 'file_key_name': 'models.int_customers_per_store'}}
[0m14:26:51.493535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02e244ee-afe0-478c-abcd-545ddb19cd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13906e74c0>]}
[0m14:26:53.563239 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m14:26:53.569410 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' in package '' which was not found
[0m14:26:53.622848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e244ee-afe0-478c-abcd-545ddb19cd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e511330>]}
[0m14:26:53.639322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e244ee-afe0-478c-abcd-545ddb19cd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13903dcc40>]}
[0m14:26:53.639972 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 8 tests, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:26:53.642570 [info ] [MainThread]: 
[0m14:26:53.643670 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:26:53.645492 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:26:53.657145 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:26:53.657658 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:26:53.657997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:53.659985 [debug] [ThreadPool]: mysql adapter: Failed connection without supplying the `database`. Trying again with `database` included.
[0m14:26:53.660909 [debug] [ThreadPool]: mysql adapter: Got an error when attempting to open a mysql connection: '2003 (HY000): Can't connect to MySQL server on 'db:5432' (111)'
[0m14:26:53.661323 [debug] [ThreadPool]: mysql adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:26:53.661654 [debug] [ThreadPool]: mysql adapter: Rolling back transaction.
[0m14:26:53.662029 [debug] [ThreadPool]: mysql adapter: Error running SQL: macro list_schemas
[0m14:26:53.662337 [debug] [ThreadPool]: mysql adapter: Rolling back transaction.
[0m14:26:53.662657 [debug] [ThreadPool]: On list_schemas: No close available on handle
[0m14:26:53.663788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:53.664145 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m14:26:53.664470 [info ] [MainThread]: 
[0m14:26:53.664871 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m14:26:53.665365 [error] [MainThread]: Encountered an error:
Database Error
  2003 (HY000): Can't connect to MySQL server on 'db:5432' (111)
[0m14:26:53.666179 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.5112097, "process_user_time": 5.445083, "process_kernel_time": 0.155573, "process_mem_max_rss": "118876", "process_out_blocks": "2104", "command_success": false, "process_in_blocks": "0"}
[0m14:26:53.666678 [debug] [MainThread]: Command `dbt build` failed at 14:26:53.666559 after 2.51 seconds
[0m14:26:53.667033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f139343d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e513e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138e54b5b0>]}
[0m14:26:53.667402 [debug] [MainThread]: Flushing usage events
[0m14:28:06.122973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac6fffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac54c7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac54c70a0>]}


============================== 14:28:06.126229 | afe55919-19ff-4768-b607-4b4fa759ad2c ==============================
[0m14:28:06.126229 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:28:06.126812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/src/dbt/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:06.249692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afe55919-19ff-4768-b607-4b4fa759ad2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac77a7af0>]}
[0m14:28:06.263106 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fbz96tp9'
[0m14:28:06.263565 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:28:06.924998 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:28:06.925803 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:28:07.435308 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:28:07.441379 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:28:07.745642 [info ] [MainThread]: Installed from version 1.0.0
[0m14:28:07.746212 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:28:07.746785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'afe55919-19ff-4768-b607-4b4fa759ad2c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac54c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac54c5ea0>]}
[0m14:28:07.747313 [info ] [MainThread]: 
[0m14:28:07.747791 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:28:07.749112 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6818829, "process_user_time": 2.756141, "process_kernel_time": 0.189693, "process_mem_max_rss": "92292", "process_out_blocks": "2184", "process_in_blocks": "0"}
[0m14:28:07.749748 [debug] [MainThread]: Command `dbt deps` succeeded at 14:28:07.749623 after 1.68 seconds
[0m14:28:07.750133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac6fffd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac550e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac54c44f0>]}
[0m14:28:07.750520 [debug] [MainThread]: Flushing usage events
[0m14:28:10.692134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654cb511b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654d0e2800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654d0e2140>]}


============================== 14:28:10.695349 | 8035ebbd-405d-427c-97a0-a61014d91b78 ==============================
[0m14:28:10.695349 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:28:10.695946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --profiles-dir profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:10.855714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8035ebbd-405d-427c-97a0-a61014d91b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654ade3c70>]}
[0m14:28:10.930033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8035ebbd-405d-427c-97a0-a61014d91b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654adf2830>]}
[0m14:28:10.930967 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:28:10.947232 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:28:10.959900 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:28:10.960510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8035ebbd-405d-427c-97a0-a61014d91b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654d0e3700>]}
[0m14:28:12.712280 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m14:28:12.725093 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' in package '' which was not found
[0m14:28:12.825428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8035ebbd-405d-427c-97a0-a61014d91b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651bdd1930>]}
[0m14:28:12.839698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8035ebbd-405d-427c-97a0-a61014d91b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651bdd3f70>]}
[0m14:28:12.840197 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 8 tests, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:28:12.842494 [info ] [MainThread]: 
[0m14:28:12.843482 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:28:12.845387 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:28:12.857236 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:28:12.857721 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:28:12.858033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:12.874797 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:28:12.876133 [debug] [ThreadPool]: On list_schemas: Close
[0m14:28:12.877615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now create__public)
[0m14:28:12.878499 [debug] [ThreadPool]: Creating schema "schema: "public"
"
[0m14:28:12.883350 [debug] [ThreadPool]: Using mysql connection "create__public"
[0m14:28:12.883817 [debug] [ThreadPool]: On create__public: BEGIN
[0m14:28:12.884180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:12.889873 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:12.890440 [debug] [ThreadPool]: Using mysql connection "create__public"
[0m14:28:12.890776 [debug] [ThreadPool]: On create__public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "create__public"} */
create schema if not exists `public`
[0m14:28:12.891664 [debug] [ThreadPool]: mysql adapter: MySQL error: 1044 (42000): Access denied for user 'ingestao'@'%' to database 'public'
[0m14:28:12.892048 [debug] [ThreadPool]: On create__public: ROLLBACK
[0m14:28:12.892696 [debug] [ThreadPool]: mysql adapter: Error running SQL: macro create_schema
[0m14:28:12.893042 [debug] [ThreadPool]: mysql adapter: Rolling back transaction.
[0m14:28:12.893374 [debug] [ThreadPool]: On create__public: Close
[0m14:28:12.894947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:12.895283 [debug] [MainThread]: Connection 'create__public' was properly closed.
[0m14:28:12.895598 [info ] [MainThread]: 
[0m14:28:12.895968 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m14:28:12.896512 [error] [MainThread]: Encountered an error:
Database Error
  1044 (42000): Access denied for user 'ingestao'@'%' to database 'public'
[0m14:28:12.897352 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.2535756, "process_user_time": 4.756787, "process_kernel_time": 0.111139, "process_mem_max_rss": "122196", "process_out_blocks": "2056", "command_success": false, "process_in_blocks": "0"}
[0m14:28:12.897870 [debug] [MainThread]: Command `dbt build` failed at 14:28:12.897755 after 2.25 seconds
[0m14:28:12.898233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f654cb511b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651bdd3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f651bd06a40>]}
[0m14:28:12.898652 [debug] [MainThread]: Flushing usage events
[0m14:29:14.611453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd397541f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a233a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a231f0>]}


============================== 14:29:14.614670 | 9d80efb1-21a4-43d1-985b-33624722db9e ==============================
[0m14:29:14.614670 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:29:14.615526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:14.721378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d80efb1-21a4-43d1-985b-33624722db9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a670d0>]}
[0m14:29:14.731896 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cl02k9oe'
[0m14:29:14.732335 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:29:15.178471 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:29:15.179439 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:29:15.548598 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:29:15.555252 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:29:15.869256 [info ] [MainThread]: Installed from version 1.0.0
[0m14:29:15.869772 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:29:15.870287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9d80efb1-21a4-43d1-985b-33624722db9e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a89e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37b09030>]}
[0m14:29:15.870693 [info ] [MainThread]: 
[0m14:29:15.871050 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:29:15.872226 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.310945, "process_user_time": 2.680599, "process_kernel_time": 0.175059, "process_mem_max_rss": "92500", "process_out_blocks": "2184", "process_in_blocks": "0"}
[0m14:29:15.872830 [debug] [MainThread]: Command `dbt deps` succeeded at 14:29:15.872711 after 1.31 seconds
[0m14:29:15.873212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd397541f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a8ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd37a898d0>]}
[0m14:29:15.873623 [debug] [MainThread]: Flushing usage events
[0m14:29:18.822545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b1aa15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aff5e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aff5e0b0>]}


============================== 14:29:18.825247 | fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2 ==============================
[0m14:29:18.825247 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:29:18.825800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'profiles', 'log_path': '/usr/src/dbt/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --profiles-dir profiles', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:18.988363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aff5f2b0>]}
[0m14:29:19.058920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aededde0>]}
[0m14:29:19.059775 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:29:19.076083 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:29:19.088278 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:29:19.088990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aec713f0>]}
[0m14:29:20.843277 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m14:29:20.849411 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' in package '' which was not found
[0m14:29:20.954570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4acfcd1e0>]}
[0m14:29:20.970276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4acfcc4f0>]}
[0m14:29:20.970804 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 8 tests, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:29:20.973126 [info ] [MainThread]: 
[0m14:29:20.974242 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:29:20.975840 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:29:20.989710 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:29:20.990338 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:29:20.990761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:21.004791 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:29:21.006191 [debug] [ThreadPool]: On list_schemas: Close
[0m14:29:21.007590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now create__public)
[0m14:29:21.008349 [debug] [ThreadPool]: Creating schema "schema: "public"
"
[0m14:29:21.013646 [debug] [ThreadPool]: Using mysql connection "create__public"
[0m14:29:21.014109 [debug] [ThreadPool]: On create__public: BEGIN
[0m14:29:21.014425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:21.020770 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.021273 [debug] [ThreadPool]: Using mysql connection "create__public"
[0m14:29:21.021609 [debug] [ThreadPool]: On create__public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "create__public"} */
create schema if not exists `public`
[0m14:29:21.038708 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:21.039969 [debug] [ThreadPool]: On create__public: COMMIT
[0m14:29:21.040493 [debug] [ThreadPool]: Using mysql connection "create__public"
[0m14:29:21.040934 [debug] [ThreadPool]: On create__public: COMMIT
[0m14:29:21.041896 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.042374 [debug] [ThreadPool]: On create__public: Close
[0m14:29:21.045231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__public, now list_None_public)
[0m14:29:21.053136 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:29:21.053784 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:29:21.054136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:21.060233 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.060683 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:29:21.061011 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:29:21.063581 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.064911 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:29:21.065648 [debug] [ThreadPool]: On list_None_public: Close
[0m14:29:21.067035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4acf620b0>]}
[0m14:29:21.067712 [debug] [MainThread]: Using mysql connection "master"
[0m14:29:21.068072 [debug] [MainThread]: On master: BEGIN
[0m14:29:21.068385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:21.075090 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.075872 [debug] [MainThread]: On master: COMMIT
[0m14:29:21.076341 [debug] [MainThread]: Using mysql connection "master"
[0m14:29:21.076667 [debug] [MainThread]: On master: COMMIT
[0m14:29:21.077565 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.077947 [debug] [MainThread]: On master: Close
[0m14:29:21.078844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:21.079304 [info ] [MainThread]: 
[0m14:29:21.087968 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m14:29:21.088600 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m14:29:21.089733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.stg_payment)
[0m14:29:21.090319 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m14:29:21.099408 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m14:29:21.100457 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (compile): 14:29:21.090685 => 14:29:21.100202
[0m14:29:21.100953 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m14:29:21.138534 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m14:29:21.139413 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:29:21.139840 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m14:29:21.140190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:21.146105 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.146671 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:29:21.147107 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view `public`.`stg_payment__dbt_tmp`
    
    
  as (
    SELECT
    *
FROM
    `public`.`payment`
  );
[0m14:29:21.148977 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.payment' doesn't exist
[0m14:29:21.149520 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: ROLLBACK
[0m14:29:21.150281 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (execute): 14:29:21.101358 => 14:29:21.150041
[0m14:29:21.150666 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m14:29:21.153384 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:29:21.154035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4acf63ca0>]}
[0m14:29:21.154726 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public.stg_payment ....................... [[31mERROR[0m in 0.06s]
[0m14:29:21.155744 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m14:29:21.156306 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:29:21.159093 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m14:29:21.160193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.stg_payment, now seed.test_dbt_project.customer_base)
[0m14:29:21.160677 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:29:21.161157 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:29:21.160926 => 14:29:21.160930
[0m14:29:21.161578 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:29:21.292985 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:29:21.293679 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:29:21.294197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:21.303104 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:21.303808 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:29:21.304335 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */

    create table `public`.`customer_base` (`customer_id` integer,`store_id` integer,`first_name` text,`last_name` text,`email` text,`address_id` integer,`activebool` text,`create_date` date,`last_update` timestamp,`active` integer)
  
[0m14:29:21.387547 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:22.797311 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:29:22.797856 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:29:22.848303 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:29:22.856612 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:29:22.878974 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:29:22.879954 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:29:22.880588 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:29:22.891649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:22.892872 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:29:21.161882 => 14:29:22.892641
[0m14:29:22.893284 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:29:22.894549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ae9e25c0>]}
[0m14:29:22.895217 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.73s]
[0m14:29:22.896159 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:29:22.897026 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:29:22.897990 [info ] [Thread-1 (]: 3 of 14 SKIP test not_null_stg_payment_customer_id ............................. [[33mSKIP[0m]
[0m14:29:22.898933 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:29:22.899552 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:29:22.900169 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_stg_payment_payment_id .............................. [[33mSKIP[0m]
[0m14:29:22.900710 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:29:22.901272 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:29:22.902047 [info ] [Thread-1 (]: 5 of 14 SKIP test unique_stg_payment_payment_id ................................ [[33mSKIP[0m]
[0m14:29:22.902648 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:29:22.903140 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:29:22.903749 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m14:29:22.904750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb)
[0m14:29:22.905207 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:29:22.919516 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:29:22.920335 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb (compile): 14:29:22.905448 => 14:29:22.920051
[0m14:29:22.920773 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:29:22.938156 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:29:22.938849 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:29:22.939380 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m14:29:22.939771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:22.945307 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:22.945807 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m14:29:22.946205 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `public`.`customer_base`
where customer_id is null



      
    ) dbt_internal_test
[0m14:29:22.947604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:22.949745 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb (execute): 14:29:22.921039 => 14:29:22.949464
[0m14:29:22.950241 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m14:29:22.950805 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m14:29:22.951777 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m14:29:22.952605 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m14:29:22.953155 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:29:22.953773 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m14:29:22.954627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb, now test.test_dbt_project.not_null_customer_base_store_id.e159464168)
[0m14:29:22.955134 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:29:22.961350 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:29:22.962172 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_customer_base_store_id.e159464168 (compile): 14:29:22.955397 => 14:29:22.961934
[0m14:29:22.962619 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:29:22.965699 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:29:22.966429 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:29:22.966797 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m14:29:22.967158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:22.972847 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:22.973541 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m14:29:22.973945 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`customer_base`
where store_id is null



      
    ) dbt_internal_test
[0m14:29:22.975179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:22.976722 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_customer_base_store_id.e159464168 (execute): 14:29:22.962901 => 14:29:22.976473
[0m14:29:22.977174 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m14:29:22.977792 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m14:29:22.978770 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.02s]
[0m14:29:22.979432 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m14:29:22.979905 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:29:22.980819 [info ] [Thread-1 (]: 8 of 14 SKIP relation public.int_revenue_by_date ............................... [[33mSKIP[0m]
[0m14:29:22.981292 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:29:22.981790 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:29:22.982610 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m14:29:22.984348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_customer_base_store_id.e159464168, now model.test_dbt_project.int_customers_per_store)
[0m14:29:22.984871 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:29:22.989262 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:29:22.990336 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:29:22.985308 => 14:29:22.990063
[0m14:29:22.991239 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:29:22.997761 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:29:22.998651 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:22.999072 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:29:22.999563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:23.005929 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.006450 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:23.006838 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:29:23.024895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.032796 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:23.033351 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:29:23.039538 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.040841 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:23.041260 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:29:23.062561 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.064587 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:29:23.065210 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:23.065651 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:29:23.066554 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.074222 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:29:23.074836 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:29:23.081131 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.082902 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:29:22.991509 => 14:29:23.082650
[0m14:29:23.083334 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:29:23.084268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ad0ca7a0>]}
[0m14:29:23.084991 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mSUCCESS 0[0m in 0.10s]
[0m14:29:23.085756 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:29:23.086312 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:29:23.087015 [info ] [Thread-1 (]: 10 of 14 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m14:29:23.087864 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:29:23.088417 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:29:23.089010 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m14:29:23.090110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:29:23.090701 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:29:23.096006 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:29:23.096858 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:29:23.090971 => 14:29:23.096582
[0m14:29:23.097314 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:29:23.102056 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:29:23.102918 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:29:23.103381 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:29:23.103730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:23.109402 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.109951 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:29:23.110402 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:29:23.112401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:23.114156 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:29:23.097549 => 14:29:23.113818
[0m14:29:23.114634 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:29:23.115394 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:29:23.116406 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.03s]
[0m14:29:23.117237 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:29:23.117754 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:29:23.118303 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m14:29:23.119230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:29:23.120003 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:29:23.125839 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:29:23.126637 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:29:23.120455 => 14:29:23.126387
[0m14:29:23.127151 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:29:23.130609 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:29:23.131346 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:29:23.131807 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:29:23.132170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:23.138061 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.138567 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:29:23.139020 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:29:23.140077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:23.141758 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:29:23.127399 => 14:29:23.141360
[0m14:29:23.142252 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:29:23.142939 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:29:23.144077 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.03s]
[0m14:29:23.145052 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:29:23.145667 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:29:23.146238 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m14:29:23.147080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:29:23.147568 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:29:23.156071 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:29:23.156924 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:29:23.147808 => 14:29:23.156630
[0m14:29:23.157444 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:29:23.161021 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:29:23.161857 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:29:23.162347 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:29:23.162701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:23.169324 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.170168 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:29:23.170770 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:29:23.172988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:29:23.175259 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:29:23.157714 => 14:29:23.174823
[0m14:29:23.175783 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:29:23.176616 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:29:23.177641 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.03s]
[0m14:29:23.178428 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:29:23.179958 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:29:23.181189 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m14:29:23.182690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:29:23.183622 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:29:23.190209 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:29:23.184124 => 14:29:23.189726
[0m14:29:23.190957 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:29:23.219563 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:29:23.220142 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:29:23.220658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:23.227365 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:29:23.274662 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:29:23.275546 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:29:23.275983 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:29:23.276943 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.277346 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:29:23.277797 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          
  
    

  create  table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
    
    
      as
    
    (
      

    select *,
        md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id,
        
    current_timestamp()
 as dbt_updated_at,
        
    current_timestamp()
 as dbt_valid_from,
        nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to
    from (
        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

    ) sbq



    )

  
      
[0m14:29:23.355404 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:29:23.357026 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:29:23.357428 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:29:23.357790 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:29:23.358644 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.359594 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:29:23.191271 => 14:29:23.359361
[0m14:29:23.360011 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:29:23.361040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb3c8e1-d6ff-4f8b-9ed6-be106dad91a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ae9e25c0>]}
[0m14:29:23.361948 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSUCCESS 2[0m in 0.18s]
[0m14:29:23.362889 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:29:23.364985 [debug] [MainThread]: Using mysql connection "master"
[0m14:29:23.365482 [debug] [MainThread]: On master: BEGIN
[0m14:29:23.365824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:23.371852 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.372344 [debug] [MainThread]: On master: COMMIT
[0m14:29:23.372665 [debug] [MainThread]: Using mysql connection "master"
[0m14:29:23.373017 [debug] [MainThread]: On master: COMMIT
[0m14:29:23.373789 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:29:23.374152 [debug] [MainThread]: On master: Close
[0m14:29:23.375042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:23.375373 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:29:23.375807 [info ] [MainThread]: 
[0m14:29:23.376203 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m14:29:23.378614 [debug] [MainThread]: Command end result
[0m14:29:23.392593 [info ] [MainThread]: 
[0m14:29:23.393146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:23.393970 [info ] [MainThread]: 
[0m14:29:23.394583 [error] [MainThread]:   Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:29:23.395139 [info ] [MainThread]: 
[0m14:29:23.395636 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=5 TOTAL=14
[0m14:29:23.396727 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.621052, "process_user_time": 6.971172, "process_kernel_time": 0.189312, "process_mem_max_rss": "127364", "process_out_blocks": "3376", "command_success": false, "process_in_blocks": "0"}
[0m14:29:23.397319 [debug] [MainThread]: Command `dbt build` failed at 14:29:23.397197 after 4.62 seconds
[0m14:29:23.397700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b1aa15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4acf62080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4aededde0>]}
[0m14:29:23.398076 [debug] [MainThread]: Flushing usage events
[0m14:45:14.357184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa4e7bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa3333310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa33330a0>]}


============================== 14:45:14.361187 | 38f718c5-aadc-4ffd-9824-9ed2d9dfe5d4 ==============================
[0m14:45:14.361187 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:45:14.361723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:45:14.477538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38f718c5-aadc-4ffd-9824-9ed2d9dfe5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa5613af0>]}
[0m14:45:14.498945 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1024dobk'
[0m14:45:14.499497 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:45:14.590580 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:45:14.591409 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:45:14.655203 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:45:14.661377 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:45:14.977635 [info ] [MainThread]: Installed from version 1.0.0
[0m14:45:14.978171 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:45:14.978604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38f718c5-aadc-4ffd-9824-9ed2d9dfe5d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa3330070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa3331ea0>]}
[0m14:45:14.979000 [info ] [MainThread]: 
[0m14:45:14.979350 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:45:14.981779 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6889075, "process_user_time": 2.819555, "process_kernel_time": 0.172186, "process_mem_max_rss": "91960", "process_in_blocks": "67736", "process_out_blocks": "2184"}
[0m14:45:14.982397 [debug] [MainThread]: Command `dbt deps` succeeded at 14:45:14.982274 after 0.69 seconds
[0m14:45:14.982893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa4e7bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa337a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa33304f0>]}
[0m14:45:14.983344 [debug] [MainThread]: Flushing usage events
[0m14:45:18.158060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23d907d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23de92770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23de92080>]}


============================== 14:45:18.160977 | 7b1211aa-39be-4407-a151-4feb5bedb4a7 ==============================
[0m14:45:18.160977 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:45:18.161736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir profiles', 'send_anonymous_usage_stats': 'True'}
[0m14:45:18.348680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23de93280>]}
[0m14:45:18.427676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a97f700>]}
[0m14:45:18.429640 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:45:18.445917 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:45:18.523176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:18.524110 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://seeds/_seeds.yml
[0m14:45:18.693895 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'teste' in the 'seeds' section of file 'seeds/_seeds.yml'
[0m14:45:18.798185 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Segmento.ab5e460551' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:45:18.798875 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_CNPJ.913e4cea6c' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:45:18.799368 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Nome.5b0049d3de' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:45:18.815985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a555390>]}
[0m14:45:18.881896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a60b430>]}
[0m14:45:18.882436 [info ] [MainThread]: Found 4 models, 1 snapshot, 6 tests, 1 seed, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:45:18.884527 [info ] [MainThread]: 
[0m14:45:18.885378 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:45:18.887061 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:45:18.899328 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:45:18.899806 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:45:18.900118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:18.924918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:45:18.926309 [debug] [ThreadPool]: On list_schemas: Close
[0m14:45:18.928497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:45:18.934864 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:45:18.935357 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:45:18.935686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:18.941445 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:18.941909 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:45:18.942445 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:45:18.944529 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:45:18.946117 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:45:18.946782 [debug] [ThreadPool]: On list_None_public: Close
[0m14:45:18.948665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a591d20>]}
[0m14:45:18.949317 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:18.949681 [debug] [MainThread]: On master: BEGIN
[0m14:45:18.949983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:18.956136 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:18.956627 [debug] [MainThread]: On master: COMMIT
[0m14:45:18.956940 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:18.957242 [debug] [MainThread]: On master: COMMIT
[0m14:45:18.957971 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:18.958301 [debug] [MainThread]: On master: Close
[0m14:45:18.959128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:18.959556 [info ] [MainThread]: 
[0m14:45:18.962440 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m14:45:18.963032 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_payment ................................ [RUN]
[0m14:45:18.963921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.stg_payment)
[0m14:45:18.964346 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m14:45:18.974135 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m14:45:18.975000 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (compile): 14:45:18.964589 => 14:45:18.974743
[0m14:45:18.975394 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m14:45:19.011685 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m14:45:19.012483 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:45:19.012907 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m14:45:19.013279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:19.019286 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:19.019803 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:45:19.020177 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view `public`.`stg_payment__dbt_tmp`
    
    
  as (
    SELECT
    *
FROM
    `public`.`payment`
  );
[0m14:45:19.021982 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.payment' doesn't exist
[0m14:45:19.022378 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: ROLLBACK
[0m14:45:19.023067 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (execute): 14:45:18.975632 => 14:45:19.022836
[0m14:45:19.023443 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m14:45:19.033066 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:45:19.033775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a638640>]}
[0m14:45:19.034420 [error] [Thread-1 (]: 1 of 12 ERROR creating sql view model public.stg_payment ....................... [[31mERROR[0m in 0.07s]
[0m14:45:19.035133 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m14:45:19.035636 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:45:19.036550 [info ] [Thread-1 (]: 2 of 12 START seed file public.customer_base ................................... [RUN]
[0m14:45:19.038011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.stg_payment, now seed.test_dbt_project.customer_base)
[0m14:45:19.039177 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:45:19.039754 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:45:19.039502 => 14:45:19.039507
[0m14:45:19.040141 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:45:19.133651 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:19.134214 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:45:19.134612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:19.140777 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:19.141323 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:19.141737 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:45:19.263267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.585045 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:20.585602 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:45:20.633115 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:45:20.639772 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:45:20.656762 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:45:20.657265 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:20.657643 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:45:20.669444 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.670647 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:45:19.040393 => 14:45:20.670419
[0m14:45:20.671069 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:45:20.671994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23a700670>]}
[0m14:45:20.672556 [info ] [Thread-1 (]: 2 of 12 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.63s]
[0m14:45:20.673326 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:45:20.673838 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:45:20.674662 [info ] [Thread-1 (]: 3 of 12 SKIP test not_null_stg_payment_customer_id ............................. [[33mSKIP[0m]
[0m14:45:20.675634 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:45:20.676309 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:45:20.677029 [info ] [Thread-1 (]: 4 of 12 SKIP test not_null_stg_payment_payment_id .............................. [[33mSKIP[0m]
[0m14:45:20.677534 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:45:20.678012 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:45:20.678532 [info ] [Thread-1 (]: 5 of 12 SKIP test unique_stg_payment_payment_id ................................ [[33mSKIP[0m]
[0m14:45:20.679002 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:45:20.679465 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:45:20.680134 [info ] [Thread-1 (]: 6 of 12 START sql view model public.int_customers_per_store .................... [RUN]
[0m14:45:20.681331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:45:20.681802 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:45:20.685179 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.686055 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:45:20.682054 => 14:45:20.685741
[0m14:45:20.686627 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:45:20.691861 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.692606 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.693015 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:45:20.693402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.699178 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.699670 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.700073 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:45:20.718718 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.726595 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.727224 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:45:20.733748 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.735057 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.735466 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:45:20.753713 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.757259 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.757737 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:45:20.763966 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.765241 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.765654 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:45:20.783994 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.789442 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:45:20.790120 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.790529 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:45:20.791660 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.797764 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:20.798276 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:45:20.818609 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.820387 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:45:20.686944 => 14:45:20.820148
[0m14:45:20.820856 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:45:20.821787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23831a2c0>]}
[0m14:45:20.822408 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.int_customers_per_store ............... [[32mSUCCESS 0[0m in 0.14s]
[0m14:45:20.823072 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:45:20.823509 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:45:20.824112 [info ] [Thread-1 (]: 7 of 12 SKIP relation public.int_revenue_by_date ............................... [[33mSKIP[0m]
[0m14:45:20.825107 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:45:20.825711 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:20.826583 [info ] [Thread-1 (]: 8 of 12 START test not_null_int_customers_per_store_store_id ................... [RUN]
[0m14:45:20.827369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:45:20.827779 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:20.840459 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:20.841453 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:45:20.828014 => 14:45:20.840970
[0m14:45:20.841857 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:20.858739 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:20.859503 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:20.859897 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:45:20.860275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.865793 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.866289 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:20.866684 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:45:20.868391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:20.870522 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:45:20.842098 => 14:45:20.870250
[0m14:45:20.870937 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:45:20.871586 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:45:20.872504 [info ] [Thread-1 (]: 8 of 12 PASS not_null_int_customers_per_store_store_id ......................... [[32mPASS[0m in 0.05s]
[0m14:45:20.873189 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:20.873669 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:20.874193 [info ] [Thread-1 (]: 9 of 12 START test not_null_int_customers_per_store_total_customers ............ [RUN]
[0m14:45:20.874849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:45:20.875241 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:20.879911 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:20.880695 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:45:20.875475 => 14:45:20.880440
[0m14:45:20.881104 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:20.883975 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:20.884697 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:20.885073 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:45:20.885422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.891031 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.891540 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:20.891959 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:45:20.893163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:20.894846 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:45:20.881343 => 14:45:20.894562
[0m14:45:20.895307 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:45:20.895867 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:45:20.896779 [info ] [Thread-1 (]: 9 of 12 PASS not_null_int_customers_per_store_total_customers .................. [[32mPASS[0m in 0.02s]
[0m14:45:20.897466 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:20.897970 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:20.898479 [info ] [Thread-1 (]: 10 of 12 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m14:45:20.899141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:45:20.899524 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:20.907570 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:20.908330 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:45:20.899756 => 14:45:20.908089
[0m14:45:20.908717 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:20.911496 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:20.912179 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:20.912647 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:45:20.913015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.918543 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:20.919047 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:20.919449 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:20.920911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:20.922497 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:45:20.908953 => 14:45:20.922239
[0m14:45:20.922899 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:45:20.923447 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:45:20.924366 [info ] [Thread-1 (]: 10 of 12 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.03s]
[0m14:45:20.925006 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:20.925566 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:45:20.926132 [info ] [Thread-1 (]: 11 of 12 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m14:45:20.927030 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:45:20.927553 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:20.928187 [info ] [Thread-1 (]: 12 of 12 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m14:45:20.928939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:45:20.929450 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:20.933704 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:45:20.929694 => 14:45:20.933391
[0m14:45:20.934178 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:20.959505 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:20.960017 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:45:20.960394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:20.966306 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:45:21.005086 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.005636 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:45:21.006821 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.013890 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.014394 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:45:21.015232 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.015605 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.015976 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:21.017977 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:21.027520 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.028071 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:21.029660 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:21.050336 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.051078 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:45:21.055017 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.058246 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.058725 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:21.060191 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:21.063935 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.064652 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:21.066563 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:21.070316 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.070888 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:21.072348 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:21.075921 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.076381 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:21.078089 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:21.085689 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.086200 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:21.087365 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:21.093043 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.093935 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.094529 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:45:21.095960 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.097254 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.097868 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.098283 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:45:21.099337 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.100818 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:45:21.101270 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:21.101675 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:45:21.102540 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.105771 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:45:20.934464 => 14:45:21.105526
[0m14:45:21.106206 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:45:21.107174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1211aa-39be-4407-a151-4feb5bedb4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2381826e0>]}
[0m14:45:21.108004 [info ] [Thread-1 (]: 12 of 12 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSUCCESS 0[0m in 0.18s]
[0m14:45:21.108718 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:21.110576 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:21.110930 [debug] [MainThread]: On master: BEGIN
[0m14:45:21.111274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:21.117168 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.117720 [debug] [MainThread]: On master: COMMIT
[0m14:45:21.118039 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:21.118346 [debug] [MainThread]: On master: COMMIT
[0m14:45:21.119036 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:21.119339 [debug] [MainThread]: On master: Close
[0m14:45:21.120203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:21.120597 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:45:21.121081 [info ] [MainThread]: 
[0m14:45:21.121555 [info ] [MainThread]: Finished running 3 view models, 1 seed, 6 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m14:45:21.124070 [debug] [MainThread]: Command end result
[0m14:45:21.137782 [info ] [MainThread]: 
[0m14:45:21.138984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:45:21.139425 [info ] [MainThread]: 
[0m14:45:21.139833 [error] [MainThread]:   Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:45:21.140334 [info ] [MainThread]: 
[0m14:45:21.140780 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m14:45:21.141868 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.0337071, "process_user_time": 5.221363, "process_kernel_time": 0.120408, "process_mem_max_rss": "119136", "process_in_blocks": "22816", "process_out_blocks": "3296", "command_success": false}
[0m14:45:21.142458 [debug] [MainThread]: Command `dbt build` failed at 14:45:21.142336 after 3.03 seconds
[0m14:45:21.142843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23d907d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23de93280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23fb53eb0>]}
[0m14:45:21.143221 [debug] [MainThread]: Flushing usage events
[0m14:45:50.087104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb382d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1af73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1af66b0>]}


============================== 14:45:50.090008 | eec74cdc-af2b-4074-b58c-e2c625a2bb6e ==============================
[0m14:45:50.090008 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:45:50.090620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:45:50.195522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec74cdc-af2b-4074-b58c-e2c625a2bb6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1b3fd60>]}
[0m14:45:50.206234 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5kuiyi6w'
[0m14:45:50.206726 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:45:50.265909 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:45:50.266649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:45:50.336811 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:45:50.343189 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:45:50.634825 [info ] [MainThread]: Installed from version 1.0.0
[0m14:45:50.635368 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:45:50.635944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eec74cdc-af2b-4074-b58c-e2c625a2bb6e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1b61ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1be0280>]}
[0m14:45:50.636371 [info ] [MainThread]: 
[0m14:45:50.636725 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:45:50.637817 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.607231, "process_user_time": 2.736673, "process_kernel_time": 0.130317, "process_mem_max_rss": "92068", "process_out_blocks": "2176", "process_in_blocks": "0"}
[0m14:45:50.638355 [debug] [MainThread]: Command `dbt deps` succeeded at 14:45:50.638234 after 0.61 seconds
[0m14:45:50.638708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb382d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1b61f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1b618d0>]}
[0m14:45:50.639074 [debug] [MainThread]: Flushing usage events
[0m14:45:53.710526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf8727d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf6bde770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf6bde080>]}


============================== 14:45:53.713344 | 38b0bb3f-d4aa-449b-aa85-19920ef222c0 ==============================
[0m14:45:53.713344 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:45:53.714167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/src/dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': 'profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:53.877363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf6bdf280>]}
[0m14:45:53.945461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf59e7700>]}
[0m14:45:53.946268 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:45:53.961062 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:45:53.999409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:53.999891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:54.007808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf576c310>]}
[0m14:45:54.023074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf5738220>]}
[0m14:45:54.023600 [info ] [MainThread]: Found 4 models, 1 snapshot, 6 tests, 1 seed, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:45:54.025822 [info ] [MainThread]: 
[0m14:45:54.026829 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:45:54.028389 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:45:54.040571 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:45:54.041096 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:45:54.041522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:54.052064 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:45:54.053588 [debug] [ThreadPool]: On list_schemas: Close
[0m14:45:54.056036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:45:54.063545 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:45:54.064044 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:45:54.064370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:54.069966 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:54.070584 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:45:54.070976 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:45:54.072646 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:45:54.073889 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:45:54.074402 [debug] [ThreadPool]: On list_None_public: Close
[0m14:45:54.076235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf57381c0>]}
[0m14:45:54.077036 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:54.077455 [debug] [MainThread]: On master: BEGIN
[0m14:45:54.077757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:54.084133 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:54.084605 [debug] [MainThread]: On master: COMMIT
[0m14:45:54.084917 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:54.085217 [debug] [MainThread]: On master: COMMIT
[0m14:45:54.085965 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:54.086313 [debug] [MainThread]: On master: Close
[0m14:45:54.087161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:54.087643 [info ] [MainThread]: 
[0m14:45:54.090816 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m14:45:54.091467 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_payment ................................ [RUN]
[0m14:45:54.092509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.stg_payment)
[0m14:45:54.092948 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m14:45:54.102802 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m14:45:54.104197 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (compile): 14:45:54.093213 => 14:45:54.103727
[0m14:45:54.104779 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m14:45:54.145622 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m14:45:54.146411 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:45:54.146981 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m14:45:54.147540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:54.153422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:54.154078 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:45:54.154550 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view `public`.`stg_payment__dbt_tmp`
    
    
  as (
    SELECT
    *
FROM
    `public`.`payment`
  );
[0m14:45:54.155851 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.payment' doesn't exist
[0m14:45:54.156295 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: ROLLBACK
[0m14:45:54.156978 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (execute): 14:45:54.105164 => 14:45:54.156748
[0m14:45:54.157347 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m14:45:54.159966 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:45:54.160557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf58f79d0>]}
[0m14:45:54.161176 [error] [Thread-1 (]: 1 of 12 ERROR creating sql view model public.stg_payment ....................... [[31mERROR[0m in 0.07s]
[0m14:45:54.161897 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m14:45:54.162383 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:45:54.163368 [info ] [Thread-1 (]: 2 of 12 START seed file public.customer_base ................................... [RUN]
[0m14:45:54.164665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.stg_payment, now seed.test_dbt_project.customer_base)
[0m14:45:54.165107 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:45:54.165580 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:45:54.165350 => 14:45:54.165353
[0m14:45:54.165944 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:45:54.247063 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:54.247571 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:45:54.247948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:54.253550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:54.254043 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:54.254421 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:45:54.371992 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:55.859009 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:55.859606 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:45:55.909549 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:45:55.916367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:45:55.933304 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:45:55.933813 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:45:55.934184 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:45:55.947243 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:55.948536 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:45:54.166176 => 14:45:55.948298
[0m14:45:55.948947 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:45:55.949835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf583b7c0>]}
[0m14:45:55.950598 [info ] [Thread-1 (]: 2 of 12 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.79s]
[0m14:45:55.951561 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:45:55.952096 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:45:55.953030 [info ] [Thread-1 (]: 3 of 12 SKIP test not_null_stg_payment_customer_id ............................. [[33mSKIP[0m]
[0m14:45:55.954115 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:45:55.954959 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:45:55.955919 [info ] [Thread-1 (]: 4 of 12 SKIP test not_null_stg_payment_payment_id .............................. [[33mSKIP[0m]
[0m14:45:55.956709 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:45:55.957282 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:45:55.957872 [info ] [Thread-1 (]: 5 of 12 SKIP test unique_stg_payment_payment_id ................................ [[33mSKIP[0m]
[0m14:45:55.958460 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:45:55.959014 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:45:55.960017 [info ] [Thread-1 (]: 6 of 12 START sql view model public.int_customers_per_store .................... [RUN]
[0m14:45:55.961163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:45:55.961778 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:45:55.965469 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:45:55.966412 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:45:55.962066 => 14:45:55.966101
[0m14:45:55.967030 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:45:55.972587 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:45:55.973321 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:55.973710 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:45:55.974069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:55.980276 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:55.980883 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:55.981327 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:45:56.000260 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.008368 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.008946 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:45:56.015265 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.016520 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.016953 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:45:56.035593 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.040347 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.040929 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:45:56.050094 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.051545 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.052075 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:45:56.076126 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.081549 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:45:56.082164 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.082544 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:45:56.083768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.090825 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:45:56.091331 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:45:56.109535 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.111316 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:45:55.967311 => 14:45:56.111081
[0m14:45:56.111732 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:45:56.112799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf43e3070>]}
[0m14:45:56.113544 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.int_customers_per_store ............... [[32mSUCCESS 0[0m in 0.15s]
[0m14:45:56.114236 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:45:56.114797 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:45:56.115585 [info ] [Thread-1 (]: 7 of 12 SKIP relation public.int_revenue_by_date ............................... [[33mSKIP[0m]
[0m14:45:56.116740 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:45:56.117374 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:56.118167 [info ] [Thread-1 (]: 8 of 12 START test not_null_int_customers_per_store_store_id ................... [RUN]
[0m14:45:56.119371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:45:56.119815 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:56.137289 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:56.138108 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:45:56.120065 => 14:45:56.137860
[0m14:45:56.138509 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:56.155745 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:56.156502 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:56.156906 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:45:56.157293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:56.163199 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.163789 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:45:56.164196 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:45:56.165957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:56.168244 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:45:56.138752 => 14:45:56.167946
[0m14:45:56.168753 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:45:56.169501 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:45:56.170607 [info ] [Thread-1 (]: 8 of 12 PASS not_null_int_customers_per_store_store_id ......................... [[32mPASS[0m in 0.05s]
[0m14:45:56.171407 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:45:56.171903 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:56.172637 [info ] [Thread-1 (]: 9 of 12 START test not_null_int_customers_per_store_total_customers ............ [RUN]
[0m14:45:56.173686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:45:56.174513 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:56.181377 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:56.182261 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:45:56.174874 => 14:45:56.182004
[0m14:45:56.182660 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:56.187058 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:56.187853 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:56.188289 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:45:56.188709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:56.194684 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.195245 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:45:56.195692 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:45:56.197137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:56.198909 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:45:56.182900 => 14:45:56.198642
[0m14:45:56.199331 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:45:56.200055 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:45:56.201026 [info ] [Thread-1 (]: 9 of 12 PASS not_null_int_customers_per_store_total_customers .................. [[32mPASS[0m in 0.03s]
[0m14:45:56.201837 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:45:56.202420 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:56.203487 [info ] [Thread-1 (]: 10 of 12 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m14:45:56.205046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:45:56.205586 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:56.217464 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:56.218491 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:45:56.205859 => 14:45:56.218096
[0m14:45:56.219014 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:56.224408 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:56.225230 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:56.225753 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:45:56.226478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:56.233116 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.233639 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:45:56.234052 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:56.235850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:45:56.237743 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:45:56.219276 => 14:45:56.237363
[0m14:45:56.238239 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:45:56.238931 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:45:56.240013 [info ] [Thread-1 (]: 10 of 12 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.04s]
[0m14:45:56.240986 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:45:56.241555 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:45:56.242337 [info ] [Thread-1 (]: 11 of 12 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m14:45:56.243323 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:45:56.244063 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:56.244799 [info ] [Thread-1 (]: 12 of 12 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m14:45:56.245717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:45:56.246210 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:56.252453 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:45:56.246459 => 14:45:56.251908
[0m14:45:56.253162 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:56.279179 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.279733 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:45:56.280138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:56.286355 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:45:56.324863 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.325452 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:45:56.326644 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.333516 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.334052 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:45:56.334902 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.335291 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.335668 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:56.337305 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:56.347073 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.347613 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:56.349251 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:56.369195 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.369911 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:45:56.374229 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.377692 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.378185 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:56.379364 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:56.382980 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.383496 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:56.385117 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:56.388708 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.389180 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:56.390497 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:56.394494 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.395031 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:45:56.396633 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:45:56.403902 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.404447 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:45:56.405604 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:45:56.411308 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.412007 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.412434 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:45:56.413771 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.414982 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.415578 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.416001 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:45:56.416957 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.418280 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:45:56.418673 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:45:56.419060 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:45:56.419811 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.423092 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:45:56.253505 => 14:45:56.422842
[0m14:45:56.423607 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:45:56.424516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38b0bb3f-d4aa-449b-aa85-19920ef222c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf440c0d0>]}
[0m14:45:56.425333 [info ] [Thread-1 (]: 12 of 12 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSUCCESS 0[0m in 0.18s]
[0m14:45:56.426172 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:45:56.428219 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:56.428702 [debug] [MainThread]: On master: BEGIN
[0m14:45:56.429017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:56.435402 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.435883 [debug] [MainThread]: On master: COMMIT
[0m14:45:56.436200 [debug] [MainThread]: Using mysql connection "master"
[0m14:45:56.436502 [debug] [MainThread]: On master: COMMIT
[0m14:45:56.437245 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:45:56.437592 [debug] [MainThread]: On master: Close
[0m14:45:56.438594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:56.439060 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:45:56.439707 [info ] [MainThread]: 
[0m14:45:56.440317 [info ] [MainThread]: Finished running 3 view models, 1 seed, 6 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m14:45:56.442672 [debug] [MainThread]: Command end result
[0m14:45:56.455381 [info ] [MainThread]: 
[0m14:45:56.455994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:45:56.456440 [info ] [MainThread]: 
[0m14:45:56.456877 [error] [MainThread]:   Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:45:56.457371 [info ] [MainThread]: 
[0m14:45:56.457971 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m14:45:56.459407 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.79992, "process_user_time": 4.997904, "process_kernel_time": 0.130664, "process_mem_max_rss": "116080", "process_out_blocks": "2280", "command_success": false, "process_in_blocks": "0"}
[0m14:45:56.460109 [debug] [MainThread]: Command `dbt build` failed at 14:45:56.459958 after 2.80 seconds
[0m14:45:56.460748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf8727d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf59e7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf42ae320>]}
[0m14:45:56.461278 [debug] [MainThread]: Flushing usage events
[0m14:49:31.566395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d4bafd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d51372e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d5134850>]}


============================== 14:49:31.570863 | 0bc84812-9d38-48ac-b666-76c141f65137 ==============================
[0m14:49:31.570863 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:49:31.571393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:31.690274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bc84812-9d38-48ac-b666-76c141f65137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d5103ac0>]}
[0m14:49:31.710959 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1xic4pq7'
[0m14:49:31.711548 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:49:31.788445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:49:31.789309 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:49:31.857395 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:49:31.865116 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:49:32.179702 [info ] [MainThread]: Installed from version 1.0.0
[0m14:49:32.180162 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:49:32.180604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0bc84812-9d38-48ac-b666-76c141f65137', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d5134520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d5135e40>]}
[0m14:49:32.181062 [info ] [MainThread]: 
[0m14:49:32.181405 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:49:32.183735 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6786408, "process_user_time": 2.708525, "process_kernel_time": 0.141408, "process_mem_max_rss": "91804", "process_in_blocks": "67464", "process_out_blocks": "2184"}
[0m14:49:32.184275 [debug] [MainThread]: Command `dbt deps` succeeded at 14:49:32.184157 after 0.68 seconds
[0m14:49:32.184625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d4bafd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d2e6b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d51343d0>]}
[0m14:49:32.184978 [debug] [MainThread]: Flushing usage events
[0m14:49:35.232991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc69f895a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6a51a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6a51a0b0>]}


============================== 14:49:35.235669 | dbd93077-66d4-46ff-9fb4-9727712b43ef ==============================
[0m14:49:35.235669 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:49:35.236275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'profiles_dir': 'profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir profiles', 'send_anonymous_usage_stats': 'True'}
[0m14:49:35.433203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6a51b2b0>]}
[0m14:49:35.501548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc67091de0>]}
[0m14:49:35.503218 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:49:35.522172 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:49:35.593237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:35.593984 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://seeds/_seeds.yml
[0m14:49:35.630127 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'teste' in the 'seeds' section of file 'seeds/_seeds.yml'
[0m14:49:35.749649 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Segmento.ab5e460551' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:49:35.750416 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_CNPJ.913e4cea6c' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:49:35.750952 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Nome.5b0049d3de' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:49:35.768909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66ce21a0>]}
[0m14:49:35.784893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66d58550>]}
[0m14:49:35.785418 [info ] [MainThread]: Found 4 models, 1 snapshot, 6 tests, 1 seed, 1 source, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:49:35.787898 [info ] [MainThread]: 
[0m14:49:35.788941 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:49:35.790794 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:49:35.803082 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:49:35.803600 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:49:35.803938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:35.834169 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:49:35.835951 [debug] [ThreadPool]: On list_schemas: Close
[0m14:49:35.838426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:49:35.844699 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:49:35.845232 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:49:35.845583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:35.851452 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:35.851911 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:49:35.852320 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:49:35.855260 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:49:35.856726 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:49:35.857468 [debug] [ThreadPool]: On list_None_public: Close
[0m14:49:35.859216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66e6a770>]}
[0m14:49:35.859748 [debug] [MainThread]: Using mysql connection "master"
[0m14:49:35.860091 [debug] [MainThread]: On master: BEGIN
[0m14:49:35.860383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:35.866034 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:35.866494 [debug] [MainThread]: On master: COMMIT
[0m14:49:35.866833 [debug] [MainThread]: Using mysql connection "master"
[0m14:49:35.867168 [debug] [MainThread]: On master: COMMIT
[0m14:49:35.867968 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:35.868333 [debug] [MainThread]: On master: Close
[0m14:49:35.869184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:35.869563 [info ] [MainThread]: 
[0m14:49:35.874828 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m14:49:35.875651 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_payment ................................ [RUN]
[0m14:49:35.876609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.stg_payment)
[0m14:49:35.877174 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m14:49:35.891088 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m14:49:35.892138 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (compile): 14:49:35.877442 => 14:49:35.891640
[0m14:49:35.892886 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m14:49:35.990007 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m14:49:35.990804 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:49:35.991215 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m14:49:35.991598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:35.997324 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:35.997942 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.stg_payment"
[0m14:49:35.998348 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view `public`.`stg_payment__dbt_tmp`
    
    
  as (
    SELECT
    *
FROM
    `public`.`payment`
  );
[0m14:49:36.000254 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.payment' doesn't exist
[0m14:49:36.000793 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: ROLLBACK
[0m14:49:36.001527 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.stg_payment (execute): 14:49:35.893231 => 14:49:36.001298
[0m14:49:36.001933 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m14:49:36.010914 [debug] [Thread-1 (]: Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:49:36.011525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66b076a0>]}
[0m14:49:36.012144 [error] [Thread-1 (]: 1 of 12 ERROR creating sql view model public.stg_payment ....................... [[31mERROR[0m in 0.14s]
[0m14:49:36.012958 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m14:49:36.013431 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:49:36.014777 [info ] [Thread-1 (]: 2 of 12 START seed file public.customer_base ................................... [RUN]
[0m14:49:36.015809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.stg_payment, now seed.test_dbt_project.customer_base)
[0m14:49:36.016312 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:49:36.016850 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:49:36.016570 => 14:49:36.016574
[0m14:49:36.017259 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:49:36.105896 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:49:36.106449 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:49:36.106839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:36.113050 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:36.113548 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:49:36.113938 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:49:36.219969 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.579870 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:49:37.580431 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:49:37.632571 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:49:37.640601 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:49:37.659212 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:49:37.659753 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:49:37.660119 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:49:37.673127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.674407 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:49:36.017555 => 14:49:37.674138
[0m14:49:37.674876 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:49:37.675863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66d9fc40>]}
[0m14:49:37.676458 [info ] [Thread-1 (]: 2 of 12 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 1.66s]
[0m14:49:37.677585 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:49:37.678700 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:49:37.679817 [info ] [Thread-1 (]: 3 of 12 SKIP test not_null_stg_payment_customer_id ............................. [[33mSKIP[0m]
[0m14:49:37.680487 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m14:49:37.681093 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:49:37.681633 [info ] [Thread-1 (]: 4 of 12 SKIP test not_null_stg_payment_payment_id .............................. [[33mSKIP[0m]
[0m14:49:37.682303 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m14:49:37.682801 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:49:37.683398 [info ] [Thread-1 (]: 5 of 12 SKIP test unique_stg_payment_payment_id ................................ [[33mSKIP[0m]
[0m14:49:37.684118 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m14:49:37.684968 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:49:37.685757 [info ] [Thread-1 (]: 6 of 12 START sql view model public.int_customers_per_store .................... [RUN]
[0m14:49:37.686721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:49:37.687184 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:49:37.690636 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.691503 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:49:37.687425 => 14:49:37.691241
[0m14:49:37.691933 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:49:37.697079 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.698251 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.698738 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:49:37.699108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.704990 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.705567 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.706006 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:49:37.725211 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.733225 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.733781 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:49:37.740146 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.741613 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.742181 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:49:37.759080 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.763398 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.763969 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:49:37.770245 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.771646 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.772057 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:49:37.790980 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.795943 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:49:37.796483 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.796964 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:49:37.797917 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.804795 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:49:37.805296 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:49:37.823059 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.824916 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:49:37.692194 => 14:49:37.824658
[0m14:49:37.825314 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:49:37.826238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc64903cd0>]}
[0m14:49:37.826831 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.int_customers_per_store ............... [[32mSUCCESS 0[0m in 0.14s]
[0m14:49:37.827495 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:49:37.828015 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:49:37.828595 [info ] [Thread-1 (]: 7 of 12 SKIP relation public.int_revenue_by_date ............................... [[33mSKIP[0m]
[0m14:49:37.829655 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:49:37.830199 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:49:37.830799 [info ] [Thread-1 (]: 8 of 12 START test not_null_int_customers_per_store_store_id ................... [RUN]
[0m14:49:37.831848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:49:37.832339 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:49:37.847117 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:49:37.848061 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:49:37.832587 => 14:49:37.847807
[0m14:49:37.848461 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:49:37.868932 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:49:37.869751 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:49:37.870144 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:49:37.870502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.876156 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.876754 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:49:37.877166 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:49:37.879155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:49:37.881815 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:49:37.848845 => 14:49:37.881467
[0m14:49:37.882313 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:49:37.883088 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:49:37.884297 [info ] [Thread-1 (]: 8 of 12 PASS not_null_int_customers_per_store_store_id ......................... [[32mPASS[0m in 0.05s]
[0m14:49:37.885132 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:49:37.885644 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:49:37.886198 [info ] [Thread-1 (]: 9 of 12 START test not_null_int_customers_per_store_total_customers ............ [RUN]
[0m14:49:37.886918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:49:37.887361 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:49:37.892738 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:49:37.893580 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:49:37.887667 => 14:49:37.893321
[0m14:49:37.893986 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:49:37.897314 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:49:37.898081 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:49:37.898492 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:49:37.898888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.905219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.905754 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:49:37.906301 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:49:37.907546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:49:37.909124 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:49:37.894501 => 14:49:37.908870
[0m14:49:37.909583 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:49:37.910217 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:49:37.911409 [info ] [Thread-1 (]: 9 of 12 PASS not_null_int_customers_per_store_total_customers .................. [[32mPASS[0m in 0.02s]
[0m14:49:37.912512 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:49:37.913125 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:49:37.913861 [info ] [Thread-1 (]: 10 of 12 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m14:49:37.914771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:49:37.915258 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:49:37.922956 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:49:37.923752 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:49:37.915507 => 14:49:37.923508
[0m14:49:37.924151 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:49:37.927114 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:49:37.927966 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:49:37.928381 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:49:37.928796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.934535 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:37.935021 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:49:37.935567 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:49:37.938062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:49:37.941948 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:49:37.924428 => 14:49:37.941553
[0m14:49:37.942498 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:49:37.943267 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:49:37.944611 [info ] [Thread-1 (]: 10 of 12 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.03s]
[0m14:49:37.946222 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:49:37.947127 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:49:37.948343 [info ] [Thread-1 (]: 11 of 12 SKIP relation public.cumulative_revenue ............................... [[33mSKIP[0m]
[0m14:49:37.949309 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:49:37.950083 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:49:37.951098 [info ] [Thread-1 (]: 12 of 12 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m14:49:37.952401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:49:37.953000 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:49:37.958465 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:49:37.953264 => 14:49:37.957869
[0m14:49:37.959362 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:49:37.990162 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:37.990806 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:49:37.991210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:37.997641 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:49:38.040736 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.041340 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:49:38.042513 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.050447 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.051051 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:49:38.052028 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.052516 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.052958 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:49:38.055312 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:49:38.064333 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.064920 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:49:38.067037 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:49:38.091572 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.092309 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:49:38.097377 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.101016 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.101541 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:49:38.103145 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:49:38.107037 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.107640 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:49:38.109512 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:49:38.113352 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.113956 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:49:38.115343 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:49:38.119179 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.119691 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:49:38.121262 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:49:38.129680 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.130216 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:49:38.131380 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:49:38.137816 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.138584 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.139032 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:49:38.140345 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.141572 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.142181 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.142595 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:49:38.143617 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.144946 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:49:38.145350 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:49:38.145763 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:49:38.146587 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.149928 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:49:37.959921 => 14:49:38.149684
[0m14:49:38.150386 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:49:38.151394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd93077-66d4-46ff-9fb4-9727712b43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6496c820>]}
[0m14:49:38.152543 [info ] [Thread-1 (]: 12 of 12 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSUCCESS 0[0m in 0.20s]
[0m14:49:38.153277 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:49:38.155297 [debug] [MainThread]: Using mysql connection "master"
[0m14:49:38.155716 [debug] [MainThread]: On master: BEGIN
[0m14:49:38.156046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:38.163269 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.163786 [debug] [MainThread]: On master: COMMIT
[0m14:49:38.164178 [debug] [MainThread]: Using mysql connection "master"
[0m14:49:38.164521 [debug] [MainThread]: On master: COMMIT
[0m14:49:38.165502 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:49:38.166024 [debug] [MainThread]: On master: Close
[0m14:49:38.167609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:38.168076 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:49:38.168588 [info ] [MainThread]: 
[0m14:49:38.169372 [info ] [MainThread]: Finished running 3 view models, 1 seed, 6 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m14:49:38.171943 [debug] [MainThread]: Command end result
[0m14:49:38.186686 [info ] [MainThread]: 
[0m14:49:38.187616 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:38.188224 [info ] [MainThread]: 
[0m14:49:38.188896 [error] [MainThread]:   Database Error in model stg_payment (models/staging/stg_payment.sql)
  1146 (42S02): Table 'public.payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/staging/stg_payment.sql
[0m14:49:38.189554 [info ] [MainThread]: 
[0m14:49:38.190199 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m14:49:38.191253 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.0102634, "process_user_time": 5.120631, "process_kernel_time": 0.185609, "process_mem_max_rss": "122088", "process_in_blocks": "22640", "process_out_blocks": "3288", "command_success": false}
[0m14:49:38.191838 [debug] [MainThread]: Command `dbt build` failed at 14:49:38.191690 after 3.01 seconds
[0m14:49:38.192238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc69f895a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66b2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc66c32d40>]}
[0m14:49:38.192658 [debug] [MainThread]: Flushing usage events
[0m14:52:04.116480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f40fd41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f2a33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f2a31f0>]}


============================== 14:52:04.119485 | 1e706d36-b26e-4976-8475-670b63447be7 ==============================
[0m14:52:04.119485 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:52:04.120073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:04.225879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e706d36-b26e-4976-8475-670b63447be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f2e70d0>]}
[0m14:52:04.236807 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f05iu3ef'
[0m14:52:04.237300 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:52:04.572364 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:52:04.573067 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:52:04.870086 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:52:04.876175 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:52:05.194379 [info ] [MainThread]: Installed from version 1.0.0
[0m14:52:05.194872 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:52:05.195451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1e706d36-b26e-4976-8475-670b63447be7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f309e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f389030>]}
[0m14:52:05.195933 [info ] [MainThread]: 
[0m14:52:05.196347 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:52:05.197496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1309115, "process_user_time": 2.59635, "process_kernel_time": 0.163635, "process_mem_max_rss": "92172", "process_out_blocks": "2184", "process_in_blocks": "0"}
[0m14:52:05.198120 [debug] [MainThread]: Command `dbt deps` succeeded at 14:52:05.197987 after 1.13 seconds
[0m14:52:05.198544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f40fd41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f30ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f3f3098d0>]}
[0m14:52:05.198935 [debug] [MainThread]: Flushing usage events
[0m14:52:11.381568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8091f4fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809040e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809040e080>]}


============================== 14:52:11.385175 | b01f86a8-689b-46d6-a849-8b0492634d76 ==============================
[0m14:52:11.385175 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:52:11.385907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir profiles', 'send_anonymous_usage_stats': 'True'}
[0m14:52:11.568801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809040f280>]}
[0m14:52:11.647963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f213700>]}
[0m14:52:11.648900 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:52:11.666335 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:52:11.708757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:52:11.710232 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/staging/_staging_sources.yml
[0m14:52:11.710889 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/staging/_staging_models.yml
[0m14:52:11.711279 [debug] [MainThread]: Partial parsing: updated file: test_dbt_project://models/staging/stg_payment.sql
[0m14:52:11.984383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d589bd0>]}
[0m14:52:12.052134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8094393eb0>]}
[0m14:52:12.052841 [info ] [MainThread]: Found 4 models, 1 snapshot, 3 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:52:12.055308 [info ] [MainThread]: 
[0m14:52:12.056368 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:52:12.058179 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:52:12.071389 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:52:12.071946 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:52:12.072291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:12.082913 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:52:12.084510 [debug] [ThreadPool]: On list_schemas: Close
[0m14:52:12.087379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:52:12.094326 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:52:12.094813 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:52:12.095150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:12.101115 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:12.101600 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:52:12.101964 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:52:12.103651 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:12.105020 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:52:12.105645 [debug] [ThreadPool]: On list_None_public: Close
[0m14:52:12.107378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808eeabbb0>]}
[0m14:52:12.107953 [debug] [MainThread]: Using mysql connection "master"
[0m14:52:12.108305 [debug] [MainThread]: On master: BEGIN
[0m14:52:12.108622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:12.114838 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:12.115479 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.115846 [debug] [MainThread]: Using mysql connection "master"
[0m14:52:12.116202 [debug] [MainThread]: On master: COMMIT
[0m14:52:12.117099 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:12.117519 [debug] [MainThread]: On master: Close
[0m14:52:12.118461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:12.118886 [info ] [MainThread]: 
[0m14:52:12.122619 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:52:12.123663 [info ] [Thread-1 (]: 1 of 8 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m14:52:12.124492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.int_revenue_by_date)
[0m14:52:12.124937 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m14:52:12.134906 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m14:52:12.136020 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (compile): 14:52:12.125200 => 14:52:12.135753
[0m14:52:12.136439 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m14:52:12.181857 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m14:52:12.183318 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:52:12.184391 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m14:52:12.184875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:12.191173 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:12.191814 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:52:12.192244 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view `public`.`int_revenue_by_date__dbt_tmp`
    
    
  as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    `public`.`stg_payment`
GROUP BY
    1
  );
[0m14:52:12.194062 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.stg_payment' doesn't exist
[0m14:52:12.194573 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: ROLLBACK
[0m14:52:12.195414 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (execute): 14:52:12.136728 => 14:52:12.195083
[0m14:52:12.195826 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m14:52:12.198454 [debug] [Thread-1 (]: Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:52:12.198998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f0e8550>]}
[0m14:52:12.199650 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model public.int_revenue_by_date ................ [[31mERROR[0m in 0.07s]
[0m14:52:12.200370 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:52:12.200898 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:52:12.201888 [info ] [Thread-1 (]: 2 of 8 START seed file public.customer_base .................................... [RUN]
[0m14:52:12.203274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_revenue_by_date, now seed.test_dbt_project.customer_base)
[0m14:52:12.203835 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:52:12.204383 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:52:12.204124 => 14:52:12.204128
[0m14:52:12.204796 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:52:12.292426 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:52:12.293003 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:52:12.293402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:12.299636 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:12.300176 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:52:12.300583 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:52:12.448641 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:13.945069 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:52:13.945867 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:52:14.000778 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:52:14.009458 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:52:14.029337 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:52:14.029897 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:52:14.030294 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:52:14.044459 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.046021 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:52:12.205132 => 14:52:14.045740
[0m14:52:14.046553 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:52:14.047664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d4f2bc0>]}
[0m14:52:14.048332 [info ] [Thread-1 (]: 2 of 8 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 1.84s]
[0m14:52:14.049106 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:52:14.049773 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:52:14.050460 [info ] [Thread-1 (]: 3 of 8 SKIP relation public.cumulative_revenue ................................. [[33mSKIP[0m]
[0m14:52:14.051949 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:52:14.052597 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:52:14.053249 [info ] [Thread-1 (]: 4 of 8 START sql view model public.int_customers_per_store ..................... [RUN]
[0m14:52:14.054263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:52:14.054837 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:52:14.059460 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.060385 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:52:14.055291 => 14:52:14.060084
[0m14:52:14.060916 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:52:14.067074 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.068337 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.069087 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:52:14.069605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:14.077462 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.078189 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.078673 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:52:14.105997 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.121317 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.122653 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:52:14.134994 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.137386 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.138488 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:52:14.162067 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.167960 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.168751 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:52:14.176307 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.179248 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.180232 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:52:14.201828 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.207105 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:52:14.207696 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.208123 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:52:14.209100 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.217043 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:52:14.218609 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:52:14.246766 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.248702 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:52:14.061285 => 14:52:14.248446
[0m14:52:14.249335 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:52:14.250730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d3860e0>]}
[0m14:52:14.251826 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.int_customers_per_store ................ [[32mSUCCESS 0[0m in 0.20s]
[0m14:52:14.252863 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:52:14.256150 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:52:14.257494 [info ] [Thread-1 (]: 5 of 8 START test not_null_int_customers_per_store_store_id .................... [RUN]
[0m14:52:14.258776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:52:14.259385 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:52:14.276352 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:52:14.277310 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:52:14.259701 => 14:52:14.276977
[0m14:52:14.277812 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:52:14.308662 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:52:14.309498 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:52:14.309991 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:52:14.310381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:14.317408 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.318037 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:52:14.318452 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:52:14.320457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:14.322934 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:52:14.278106 => 14:52:14.322580
[0m14:52:14.323539 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:52:14.324376 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:52:14.325537 [info ] [Thread-1 (]: 5 of 8 PASS not_null_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.07s]
[0m14:52:14.326408 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:52:14.326953 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:52:14.327558 [info ] [Thread-1 (]: 6 of 8 START test not_null_int_customers_per_store_total_customers ............. [RUN]
[0m14:52:14.328442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:52:14.328938 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:52:14.335484 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:52:14.336468 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:52:14.329219 => 14:52:14.336188
[0m14:52:14.336905 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:52:14.340339 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:52:14.341116 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:52:14.341523 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:52:14.341986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:14.350619 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.351298 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:52:14.351763 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:52:14.352917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:14.354669 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:52:14.337159 => 14:52:14.354354
[0m14:52:14.355184 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:52:14.356116 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:52:14.357288 [info ] [Thread-1 (]: 6 of 8 PASS not_null_int_customers_per_store_total_customers ................... [[32mPASS[0m in 0.03s]
[0m14:52:14.358294 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:52:14.358898 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:52:14.359481 [info ] [Thread-1 (]: 7 of 8 START test unique_int_customers_per_store_store_id ...................... [RUN]
[0m14:52:14.360458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:52:14.360895 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:52:14.372587 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:52:14.373562 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:52:14.361148 => 14:52:14.373262
[0m14:52:14.374005 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:52:14.377460 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:52:14.378376 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:52:14.378814 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:52:14.379195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:14.385555 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.386127 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:52:14.386577 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:52:14.388135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:14.390030 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:52:14.374268 => 14:52:14.389737
[0m14:52:14.390533 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:52:14.391305 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:52:14.392600 [info ] [Thread-1 (]: 7 of 8 PASS unique_int_customers_per_store_store_id ............................ [[32mPASS[0m in 0.03s]
[0m14:52:14.393473 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:52:14.395070 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:52:14.395714 [info ] [Thread-1 (]: 8 of 8 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot .. [RUN]
[0m14:52:14.396544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:52:14.396983 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:52:14.401554 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:52:14.397237 => 14:52:14.401173
[0m14:52:14.402200 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:52:14.430227 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.430832 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:52:14.431250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:14.438137 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:52:14.482802 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.483495 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:52:14.485127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.493474 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.494078 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:52:14.495017 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.495459 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.495873 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:52:14.497776 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:14.508915 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.509483 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:52:14.511619 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:14.536823 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.537596 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:52:14.541909 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.545478 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.545966 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:52:14.547354 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:52:14.552575 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.553125 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:52:14.555033 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:14.558968 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.559448 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:52:14.560630 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:52:14.564436 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.564919 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:52:14.566813 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:14.574680 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.575262 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:52:14.576708 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:52:14.583313 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.584140 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.584598 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:52:14.585836 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.587073 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.587717 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.588182 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:52:14.589281 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.590739 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:52:14.591193 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:52:14.591589 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:52:14.592439 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.595802 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:52:14.402475 => 14:52:14.595537
[0m14:52:14.596276 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:52:14.597244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01f86a8-689b-46d6-a849-8b0492634d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808d4f2260>]}
[0m14:52:14.598110 [info ] [Thread-1 (]: 8 of 8 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot .. [[32mSUCCESS 0[0m in 0.20s]
[0m14:52:14.599000 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:52:14.601224 [debug] [MainThread]: Using mysql connection "master"
[0m14:52:14.601715 [debug] [MainThread]: On master: BEGIN
[0m14:52:14.602076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:14.608929 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.609477 [debug] [MainThread]: On master: COMMIT
[0m14:52:14.609844 [debug] [MainThread]: Using mysql connection "master"
[0m14:52:14.610188 [debug] [MainThread]: On master: COMMIT
[0m14:52:14.610984 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:52:14.611385 [debug] [MainThread]: On master: Close
[0m14:52:14.612319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:14.612714 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:52:14.613282 [info ] [MainThread]: 
[0m14:52:14.613839 [info ] [MainThread]: Finished running 2 view models, 1 seed, 1 table model, 3 tests, 1 snapshot in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m14:52:14.616351 [debug] [MainThread]: Command end result
[0m14:52:14.629461 [info ] [MainThread]: 
[0m14:52:14.630466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:14.631582 [info ] [MainThread]: 
[0m14:52:14.632124 [error] [MainThread]:   Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:52:14.632614 [info ] [MainThread]: 
[0m14:52:14.633080 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m14:52:14.634408 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.3075523, "process_user_time": 5.341352, "process_kernel_time": 0.175974, "process_mem_max_rss": "119468", "process_in_blocks": "480", "process_out_blocks": "3256", "command_success": false}
[0m14:52:14.635061 [debug] [MainThread]: Command `dbt build` failed at 14:52:14.634930 after 3.31 seconds
[0m14:52:14.635600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8091f4fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808ef651b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f808f213700>]}
[0m14:52:14.636073 [debug] [MainThread]: Flushing usage events
[0m14:53:12.065837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4e223d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c6ef310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c6ef0a0>]}


============================== 14:53:12.068611 | c0e46ed5-0935-4784-889b-222ea7879cc2 ==============================
[0m14:53:12.068611 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:53:12.069124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:12.167173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e46ed5-0935-4784-889b-222ea7879cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4e9cfaf0>]}
[0m14:53:12.177524 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_219h_40'
[0m14:53:12.177958 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:53:12.256652 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:53:12.257438 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:53:12.318978 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:53:12.326063 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:53:12.622942 [info ] [MainThread]: Installed from version 1.0.0
[0m14:53:12.623508 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:53:12.623961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c0e46ed5-0935-4784-889b-222ea7879cc2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c6ec070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c6edea0>]}
[0m14:53:12.624364 [info ] [MainThread]: 
[0m14:53:12.624722 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:53:12.625812 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6100372, "process_user_time": 2.608505, "process_kernel_time": 0.120561, "process_mem_max_rss": "92136", "process_out_blocks": "2176", "process_in_blocks": "0"}
[0m14:53:12.626484 [debug] [MainThread]: Command `dbt deps` succeeded at 14:53:12.626344 after 0.61 seconds
[0m14:53:12.626854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4e223d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c7321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c6ec4f0>]}
[0m14:53:12.627229 [debug] [MainThread]: Flushing usage events
[0m14:53:15.736960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76123ad5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76106767a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76106760b0>]}


============================== 14:53:15.739791 | f4688bad-3001-47a7-876b-e02c87b444b4 ==============================
[0m14:53:15.739791 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:53:15.740324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'debug': 'False', 'profiles_dir': 'profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir profiles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:15.897806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76106772b0>]}
[0m14:53:15.970001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f501de0>]}
[0m14:53:15.970802 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:53:15.987172 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:53:16.027790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:16.028340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:16.036763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f1f00d0>]}
[0m14:53:16.056300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f1bc520>]}
[0m14:53:16.056909 [info ] [MainThread]: Found 4 models, 1 snapshot, 3 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:53:16.059929 [info ] [MainThread]: 
[0m14:53:16.061728 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:53:16.064183 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:53:16.079410 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:53:16.080209 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:53:16.080607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:16.095141 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:53:16.096547 [debug] [ThreadPool]: On list_schemas: Close
[0m14:53:16.098757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:53:16.104830 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:53:16.105266 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:53:16.105622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:16.111225 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:16.111707 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:53:16.112066 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:53:16.114882 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:53:16.116353 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:53:16.116933 [debug] [ThreadPool]: On list_None_public: Close
[0m14:53:16.118567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f043eb0>]}
[0m14:53:16.119125 [debug] [MainThread]: Using mysql connection "master"
[0m14:53:16.119472 [debug] [MainThread]: On master: BEGIN
[0m14:53:16.119768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:16.125410 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:16.125876 [debug] [MainThread]: On master: COMMIT
[0m14:53:16.126184 [debug] [MainThread]: Using mysql connection "master"
[0m14:53:16.126483 [debug] [MainThread]: On master: COMMIT
[0m14:53:16.127095 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:16.127409 [debug] [MainThread]: On master: Close
[0m14:53:16.128251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:16.128725 [info ] [MainThread]: 
[0m14:53:16.131507 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:53:16.132133 [info ] [Thread-1 (]: 1 of 8 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m14:53:16.133276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.int_revenue_by_date)
[0m14:53:16.133689 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m14:53:16.142441 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m14:53:16.143512 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (compile): 14:53:16.133934 => 14:53:16.143063
[0m14:53:16.144734 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m14:53:16.181415 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m14:53:16.182158 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:53:16.182576 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m14:53:16.182947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:16.188513 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:16.189004 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:53:16.189386 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view `public`.`int_revenue_by_date__dbt_tmp`
    
    
  as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    `public`.`stg_payment`
GROUP BY
    1
  );
[0m14:53:16.190848 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.stg_payment' doesn't exist
[0m14:53:16.191230 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: ROLLBACK
[0m14:53:16.191901 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (execute): 14:53:16.144975 => 14:53:16.191675
[0m14:53:16.192272 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m14:53:16.194830 [debug] [Thread-1 (]: Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:53:16.195365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f0479d0>]}
[0m14:53:16.195993 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model public.int_revenue_by_date ................ [[31mERROR[0m in 0.06s]
[0m14:53:16.196769 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:53:16.197289 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:53:16.198204 [info ] [Thread-1 (]: 2 of 8 START seed file public.customer_base .................................... [RUN]
[0m14:53:16.199384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_revenue_by_date, now seed.test_dbt_project.customer_base)
[0m14:53:16.199931 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:53:16.200590 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:53:16.200188 => 14:53:16.200192
[0m14:53:16.201340 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:53:16.289389 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:53:16.289883 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:53:16.290234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:16.295822 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:16.296316 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:53:16.296679 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:53:16.400066 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.770599 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:53:20.771268 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:53:20.826054 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:53:20.833448 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:53:20.852196 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:53:20.852774 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:53:20.853177 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:53:20.865155 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.866474 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:53:16.201653 => 14:53:20.866226
[0m14:53:20.866998 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:53:20.867989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760f1d4580>]}
[0m14:53:20.868570 [info ] [Thread-1 (]: 2 of 8 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 4.67s]
[0m14:53:20.869261 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:53:20.869797 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:53:20.870445 [info ] [Thread-1 (]: 3 of 8 SKIP relation public.cumulative_revenue ................................. [[33mSKIP[0m]
[0m14:53:20.871354 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:53:20.871900 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:53:20.872580 [info ] [Thread-1 (]: 4 of 8 START sql view model public.int_customers_per_store ..................... [RUN]
[0m14:53:20.873477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:53:20.874038 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:53:20.877671 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.878452 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:53:20.874303 => 14:53:20.878201
[0m14:53:20.878864 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:53:20.884153 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.884991 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.885417 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:53:20.885912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:20.892084 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.892632 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.893065 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:53:20.911301 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.919269 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.919876 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:53:20.926592 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.928046 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.928515 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:53:20.948482 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.952321 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.952781 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:53:20.959412 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.960667 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.961083 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:53:20.983807 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.988453 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:53:20.989003 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.989405 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:53:20.990421 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:20.998116 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:53:20.998710 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:53:21.019169 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.021150 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:53:20.879120 => 14:53:21.020894
[0m14:53:21.021629 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:53:21.022901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760ce60700>]}
[0m14:53:21.023898 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.int_customers_per_store ................ [[32mSUCCESS 0[0m in 0.15s]
[0m14:53:21.024766 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:53:21.026264 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:53:21.026854 [info ] [Thread-1 (]: 5 of 8 START test not_null_int_customers_per_store_store_id .................... [RUN]
[0m14:53:21.028072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:53:21.029003 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:53:21.044674 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:53:21.045539 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:53:21.029397 => 14:53:21.045270
[0m14:53:21.045989 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:53:21.067373 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:53:21.068298 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:53:21.068790 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:53:21.069189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:21.076146 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.076857 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:53:21.077429 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:53:21.080145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:21.083214 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:53:21.046266 => 14:53:21.082766
[0m14:53:21.083796 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:53:21.084614 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:53:21.085798 [info ] [Thread-1 (]: 5 of 8 PASS not_null_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.06s]
[0m14:53:21.086726 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:53:21.087289 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:53:21.088057 [info ] [Thread-1 (]: 6 of 8 START test not_null_int_customers_per_store_total_customers ............. [RUN]
[0m14:53:21.089353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:53:21.090085 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:53:21.096804 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:53:21.098393 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:53:21.090480 => 14:53:21.097849
[0m14:53:21.098890 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:53:21.103713 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:53:21.104914 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:53:21.105408 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:53:21.106182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:21.112723 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.113315 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:53:21.113826 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:53:21.115209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:21.117375 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:53:21.099153 => 14:53:21.117017
[0m14:53:21.117956 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:53:21.118799 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:53:21.120314 [info ] [Thread-1 (]: 6 of 8 PASS not_null_int_customers_per_store_total_customers ................... [[32mPASS[0m in 0.03s]
[0m14:53:21.121325 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:53:21.122030 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:53:21.122876 [info ] [Thread-1 (]: 7 of 8 START test unique_int_customers_per_store_store_id ...................... [RUN]
[0m14:53:21.123843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:53:21.124357 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:53:21.133209 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:53:21.134115 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:53:21.124627 => 14:53:21.133818
[0m14:53:21.134632 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:53:21.140012 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:53:21.140848 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:53:21.141353 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:53:21.141790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:21.147975 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.148520 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:53:21.148962 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:53:21.150759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:21.152608 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:53:21.134898 => 14:53:21.152318
[0m14:53:21.153155 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:53:21.153849 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:53:21.154953 [info ] [Thread-1 (]: 7 of 8 PASS unique_int_customers_per_store_store_id ............................ [[32mPASS[0m in 0.03s]
[0m14:53:21.155907 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:53:21.157291 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:53:21.157868 [info ] [Thread-1 (]: 8 of 8 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot .. [RUN]
[0m14:53:21.158939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:53:21.159401 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:53:21.164139 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:53:21.159660 => 14:53:21.163783
[0m14:53:21.164688 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:53:21.193124 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.193686 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:53:21.194095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:21.200932 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:53:21.242672 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.243254 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:53:21.244743 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.252875 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.253473 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:53:21.254460 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.254917 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.255329 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:53:21.257719 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:21.267774 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.268356 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:53:21.270164 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:21.293668 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.294593 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:53:21.300039 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.303729 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.304331 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:53:21.305962 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:53:21.309978 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.310553 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:53:21.312180 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:21.316185 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.316732 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:53:21.317798 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:53:21.321594 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.322182 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:53:21.324054 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:21.332607 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.333200 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:53:21.334518 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:53:21.341132 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.341978 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.342486 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:53:21.343767 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.345043 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.346056 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.346546 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:53:21.347576 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.349083 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:53:21.349542 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:53:21.349958 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:53:21.350937 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.354816 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:53:21.164962 => 14:53:21.354499
[0m14:53:21.355359 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:53:21.356856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4688bad-3001-47a7-876b-e02c87b444b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760ceac460>]}
[0m14:53:21.359391 [info ] [Thread-1 (]: 8 of 8 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot .. [[32mSUCCESS 0[0m in 0.20s]
[0m14:53:21.360224 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:53:21.362377 [debug] [MainThread]: Using mysql connection "master"
[0m14:53:21.363025 [debug] [MainThread]: On master: BEGIN
[0m14:53:21.363451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:21.371386 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.371882 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.372222 [debug] [MainThread]: Using mysql connection "master"
[0m14:53:21.372553 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.373336 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:53:21.373841 [debug] [MainThread]: On master: Close
[0m14:53:21.374784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:21.375193 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:53:21.375676 [info ] [MainThread]: 
[0m14:53:21.376142 [info ] [MainThread]: Finished running 2 view models, 1 seed, 1 table model, 3 tests, 1 snapshot in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m14:53:21.378217 [debug] [MainThread]: Command end result
[0m14:53:21.393417 [info ] [MainThread]: 
[0m14:53:21.394069 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:21.394474 [info ] [MainThread]: 
[0m14:53:21.394933 [error] [MainThread]:   Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:53:21.395469 [info ] [MainThread]: 
[0m14:53:21.396109 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m14:53:21.398068 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.7813907, "process_user_time": 4.984659, "process_kernel_time": 0.11817, "process_mem_max_rss": "114964", "process_out_blocks": "2248", "command_success": false, "process_in_blocks": "0"}
[0m14:53:21.398877 [debug] [MainThread]: Command `dbt build` failed at 14:53:21.398734 after 2.78 seconds
[0m14:53:21.399316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76123ad5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cf19900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cf1b670>]}
[0m14:53:21.399754 [debug] [MainThread]: Flushing usage events
[0m14:55:04.526533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3219fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3272f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3272f280>]}


============================== 14:55:04.529304 | e0b4fc8c-fba1-4343-8e14-2b46c3dc4cee ==============================
[0m14:55:04.529304 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:55:04.529854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:04.626840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b4fc8c-fba1-4343-8e14-2b46c3dc4cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e326fbd90>]}
[0m14:55:04.637748 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qtyaowjt'
[0m14:55:04.638270 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:55:04.701793 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:55:04.702773 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:55:04.780731 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:55:04.791986 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:55:05.108950 [info ] [MainThread]: Installed from version 1.0.0
[0m14:55:05.109420 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:55:05.109861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e0b4fc8c-fba1-4343-8e14-2b46c3dc4cee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e30481420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e304818d0>]}
[0m14:55:05.110777 [info ] [MainThread]: 
[0m14:55:05.111383 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:55:05.112610 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6358167, "process_user_time": 2.579896, "process_kernel_time": 0.097559, "process_mem_max_rss": "92112", "process_out_blocks": "2184", "process_in_blocks": "0"}
[0m14:55:05.113276 [debug] [MainThread]: Command `dbt deps` succeeded at 14:55:05.113085 after 0.64 seconds
[0m14:55:05.113666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3219fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e304818d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e30483700>]}
[0m14:55:05.114060 [debug] [MainThread]: Flushing usage events
[0m14:55:08.120450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997af15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1995fba7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1995fba0b0>]}


============================== 14:55:08.123267 | 2984307d-166c-45ed-b5e5-762472b88ff1 ==============================
[0m14:55:08.123267 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:55:08.123850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'profiles', 'log_path': '/usr/src/dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --profiles-dir profiles', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:08.280868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1995fbb2b0>]}
[0m14:55:08.350209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1994e3dde0>]}
[0m14:55:08.351038 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:55:08.366286 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:55:08.366995 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:55:08.367452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1994da3ac0>]}
[0m14:55:10.053372 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'teste' in the 'seeds' section of file 'seeds/_seeds.yml'
[0m14:55:10.230693 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m14:55:10.234842 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Segmento.ab5e460551' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:55:10.235593 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_CNPJ.913e4cea6c' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:55:10.236200 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_teste_Nome.5b0049d3de' (seeds/_seeds.yml) depends on a node named 'teste' in package '' which was not found
[0m14:55:10.236893 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' in package '' which was not found
[0m14:55:10.281618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986de99c0>]}
[0m14:55:10.296389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1994cc4f10>]}
[0m14:55:10.296974 [info ] [MainThread]: Found 4 models, 1 snapshot, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 487 macros, 0 groups, 0 semantic models
[0m14:55:10.299108 [info ] [MainThread]: 
[0m14:55:10.300231 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:55:10.301955 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:55:10.315142 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:55:10.315678 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:55:10.316041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:10.330822 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:55:10.332353 [debug] [ThreadPool]: On list_schemas: Close
[0m14:55:10.334867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_schemas, now list_None_public)
[0m14:55:10.341417 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:55:10.341870 [debug] [ThreadPool]: On list_None_public: BEGIN
[0m14:55:10.342193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:10.348377 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:10.348862 [debug] [ThreadPool]: Using mysql connection "list_None_public"
[0m14:55:10.349221 [debug] [ThreadPool]: On list_None_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_None_public"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'public'
  
[0m14:55:10.351777 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:55:10.353360 [debug] [ThreadPool]: On list_None_public: ROLLBACK
[0m14:55:10.353999 [debug] [ThreadPool]: On list_None_public: Close
[0m14:55:10.356007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986c61240>]}
[0m14:55:10.356686 [debug] [MainThread]: Using mysql connection "master"
[0m14:55:10.357040 [debug] [MainThread]: On master: BEGIN
[0m14:55:10.357364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:10.363393 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:10.363885 [debug] [MainThread]: On master: COMMIT
[0m14:55:10.364225 [debug] [MainThread]: Using mysql connection "master"
[0m14:55:10.364553 [debug] [MainThread]: On master: COMMIT
[0m14:55:10.365241 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:10.365590 [debug] [MainThread]: On master: Close
[0m14:55:10.366520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:10.366934 [info ] [MainThread]: 
[0m14:55:10.369890 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m14:55:10.370506 [info ] [Thread-1 (]: 1 of 8 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m14:55:10.371341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_None_public, now model.test_dbt_project.int_revenue_by_date)
[0m14:55:10.371791 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m14:55:10.381440 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m14:55:10.383793 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (compile): 14:55:10.372048 => 14:55:10.383513
[0m14:55:10.384229 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m14:55:10.422249 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m14:55:10.424596 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:55:10.425022 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m14:55:10.425406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:10.431262 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:10.431825 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_revenue_by_date"
[0m14:55:10.432303 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view `public`.`int_revenue_by_date__dbt_tmp`
    
    
  as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    `public`.`stg_payment`
GROUP BY
    1
  );
[0m14:55:10.434078 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1146 (42S02): Table 'public.stg_payment' doesn't exist
[0m14:55:10.434576 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: ROLLBACK
[0m14:55:10.435362 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_revenue_by_date (execute): 14:55:10.384489 => 14:55:10.435090
[0m14:55:10.435801 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m14:55:10.438766 [debug] [Thread-1 (]: Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:55:10.439354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986c77400>]}
[0m14:55:10.440050 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model public.int_revenue_by_date ................ [[31mERROR[0m in 0.07s]
[0m14:55:10.440884 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m14:55:10.441432 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m14:55:10.442381 [info ] [Thread-1 (]: 2 of 8 START seed file public.customer_base .................................... [RUN]
[0m14:55:10.443619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_revenue_by_date, now seed.test_dbt_project.customer_base)
[0m14:55:10.444366 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m14:55:10.445163 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (compile): 14:55:10.444843 => 14:55:10.444850
[0m14:55:10.445603 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m14:55:10.596389 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:55:10.596995 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m14:55:10.597384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:10.603904 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:10.604638 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:55:10.605055 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table `public`.`customer_base`
[0m14:55:10.732396 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.225459 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:55:12.226050 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into `public`.`customer_base` (`customer_id`, `store_id`, `first_name`, `last_name`, `email`, `address_id`, `activebool`, `create_date`, `last_update`, `active`) values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m14:55:12.276223 [debug] [Thread-1 (]: SQL status: SUCCESS 599 in 0.0 seconds
[0m14:55:12.283280 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m14:55:12.300724 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:55:12.301235 [debug] [Thread-1 (]: Using mysql connection "seed.test_dbt_project.customer_base"
[0m14:55:12.301598 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m14:55:12.313375 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.314890 [debug] [Thread-1 (]: Timing info for seed.test_dbt_project.customer_base (execute): 14:55:10.445874 => 14:55:12.314475
[0m14:55:12.315383 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m14:55:12.316411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986fcb8b0>]}
[0m14:55:12.317116 [info ] [Thread-1 (]: 2 of 8 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 1.87s]
[0m14:55:12.317763 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m14:55:12.318239 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m14:55:12.319101 [info ] [Thread-1 (]: 3 of 8 SKIP relation public.cumulative_revenue ................................. [[33mSKIP[0m]
[0m14:55:12.320183 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m14:55:12.320920 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m14:55:12.321651 [info ] [Thread-1 (]: 4 of 8 START sql view model public.int_customers_per_store ..................... [RUN]
[0m14:55:12.322901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.test_dbt_project.customer_base, now model.test_dbt_project.int_customers_per_store)
[0m14:55:12.323534 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m14:55:12.327250 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.328061 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (compile): 14:55:12.323783 => 14:55:12.327802
[0m14:55:12.328468 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m14:55:12.333842 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.334554 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.334937 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m14:55:12.335451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:12.342044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.342533 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.342951 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view `public`.`int_customers_per_store__dbt_tmp`
    
    
  as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    `public`.`customer_base`
GROUP BY
    1
  );
[0m14:55:12.362019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.371307 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.371890 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store__dbt_backup` cascade
  
[0m14:55:12.382666 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.383967 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.384402 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store` to `public`.`int_customers_per_store__dbt_backup`
  
[0m14:55:12.402828 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.407004 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.407507 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    drop view if exists `public`.`int_customers_per_store` cascade
  
[0m14:55:12.413518 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.414822 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.415241 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

    rename table `public`.`int_customers_per_store__dbt_tmp` to `public`.`int_customers_per_store`
  
[0m14:55:12.433753 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.438155 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:55:12.438705 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.439071 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m14:55:12.439995 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.445998 [debug] [Thread-1 (]: Using mysql connection "model.test_dbt_project.int_customers_per_store"
[0m14:55:12.446551 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists `public`.`int_customers_per_store__dbt_backup`
[0m14:55:12.466205 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.468365 [debug] [Thread-1 (]: Timing info for model.test_dbt_project.int_customers_per_store (execute): 14:55:12.328819 => 14:55:12.468075
[0m14:55:12.468976 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m14:55:12.470005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986e5ddb0>]}
[0m14:55:12.470725 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.int_customers_per_store ................ [[32mSUCCESS 0[0m in 0.15s]
[0m14:55:12.471650 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m14:55:12.473054 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:55:12.473724 [info ] [Thread-1 (]: 5 of 8 START test not_null_int_customers_per_store_store_id .................... [RUN]
[0m14:55:12.474562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_dbt_project.int_customers_per_store, now test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33)
[0m14:55:12.474993 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:55:12.489205 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:55:12.490404 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (compile): 14:55:12.475284 => 14:55:12.490149
[0m14:55:12.490803 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:55:12.509976 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:55:12.511235 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:55:12.511658 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m14:55:12.512026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:12.517751 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.518279 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m14:55:12.518699 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select store_id
from `public`.`int_customers_per_store`
where store_id is null



      
    ) dbt_internal_test
[0m14:55:12.520602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:55:12.523142 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33 (execute): 14:55:12.491096 => 14:55:12.522821
[0m14:55:12.524049 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m14:55:12.524708 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m14:55:12.525784 [info ] [Thread-1 (]: 5 of 8 PASS not_null_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.05s]
[0m14:55:12.526505 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m14:55:12.527007 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:55:12.527572 [info ] [Thread-1 (]: 6 of 8 START test not_null_int_customers_per_store_total_customers ............. [RUN]
[0m14:55:12.528488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33, now test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc)
[0m14:55:12.528935 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:55:12.534812 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:55:12.535602 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (compile): 14:55:12.529188 => 14:55:12.535341
[0m14:55:12.536042 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:55:12.539638 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:55:12.540412 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:55:12.540819 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m14:55:12.541198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:12.547131 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.547622 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m14:55:12.548046 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select total_customers
from `public`.`int_customers_per_store`
where total_customers is null



      
    ) dbt_internal_test
[0m14:55:12.549104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:55:12.550955 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc (execute): 14:55:12.536308 => 14:55:12.550602
[0m14:55:12.551511 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m14:55:12.552239 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m14:55:12.553375 [info ] [Thread-1 (]: 6 of 8 PASS not_null_int_customers_per_store_total_customers ................... [[32mPASS[0m in 0.03s]
[0m14:55:12.554148 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m14:55:12.554655 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:55:12.555738 [info ] [Thread-1 (]: 7 of 8 START test unique_int_customers_per_store_store_id ...................... [RUN]
[0m14:55:12.557022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc, now test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d)
[0m14:55:12.557563 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:55:12.566493 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:55:12.568130 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (compile): 14:55:12.557801 => 14:55:12.567179
[0m14:55:12.568621 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:55:12.572406 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:55:12.573204 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:55:12.573624 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m14:55:12.573971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:12.579695 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.580233 [debug] [Thread-1 (]: Using mysql connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m14:55:12.580794 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from `public`.`int_customers_per_store`
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:12.582515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:55:12.584304 [debug] [Thread-1 (]: Timing info for test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d (execute): 14:55:12.569007 => 14:55:12.583966
[0m14:55:12.584742 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m14:55:12.585322 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m14:55:12.586305 [info ] [Thread-1 (]: 7 of 8 PASS unique_int_customers_per_store_store_id ............................ [[32mPASS[0m in 0.03s]
[0m14:55:12.587035 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m14:55:12.588247 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:55:12.589384 [info ] [Thread-1 (]: 8 of 8 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot .. [RUN]
[0m14:55:12.590365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d, now snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot)
[0m14:55:12.590826 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:55:12.595707 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (compile): 14:55:12.591070 => 14:55:12.595180
[0m14:55:12.596422 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:55:12.626654 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.627197 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select distinct schema_name
        from information_schema.schemata
[0m14:55:12.627611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:12.633919 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:55:12.672889 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.673453 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
        select total_customers from (
                

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:55:12.674694 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.682134 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.682664 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m14:55:12.683638 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.684100 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.684488 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:55:12.687208 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:55:12.695873 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.696481 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:55:12.698158 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:55:12.718912 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.719611 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table
    `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`
    
    
      as
    
    (
      with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        `public`.`int_customers_per_store`


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from `public`.`int_stock_balances_daily_grouped_by_day_snapshot`
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            nullif(
    current_timestamp()
, 
    current_timestamp()
) as dbt_valid_to,
            md5(concat_ws('|',coalesce(cast(store_id as char), '')
        , coalesce(cast(
    current_timestamp()
 as char), '')
        )) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.`total_customers` != source_data.`total_customers`
        or
        (
            ((snapshotted_data.`total_customers` is null) and not (source_data.`total_customers` is null))
            or
            ((not snapshotted_data.`total_customers` is null) and (source_data.`total_customers` is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

  
    
[0m14:55:12.724217 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.727669 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.728135 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:55:12.729750 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:55:12.734490 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.735150 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:55:12.737068 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:55:12.742121 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.742734 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:55:12.743890 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:55:12.747561 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.748032 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot
    
[0m14:55:12.749640 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:55:12.757196 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.757712 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        show columns from public.int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp
    
[0m14:55:12.758867 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:55:12.765173 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.766327 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.766757 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          update `public`.`int_stock_balances_daily_grouped_by_day_snapshot`, (select dbt_scd_id, dbt_change_type, dbt_valid_to from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp`) as DBT_INTERNAL_SOURCE
    set `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    where DBT_INTERNAL_SOURCE.dbt_scd_id = `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_scd_id
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
    and `public`.`int_stock_balances_daily_grouped_by_day_snapshot`.dbt_valid_to is null

      
[0m14:55:12.768019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.769254 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.769899 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.770316 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

          insert into `public`.`int_stock_balances_daily_grouped_by_day_snapshot` (`store_id`, `total_customers`, `CURRENT_DATE`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
    select DBT_INTERNAL_SOURCE.`store_id`,DBT_INTERNAL_SOURCE.`total_customers`,DBT_INTERNAL_SOURCE.`CURRENT_DATE`,DBT_INTERNAL_SOURCE.`dbt_updated_at`,DBT_INTERNAL_SOURCE.`dbt_valid_from`,DBT_INTERNAL_SOURCE.`dbt_valid_to`,DBT_INTERNAL_SOURCE.`dbt_scd_id`
    from `public`.`int_stock_balances_daily_grouped_by_day_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
[0m14:55:12.771381 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.772932 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:55:12.773427 [debug] [Thread-1 (]: Using mysql connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m14:55:12.773794 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m14:55:12.774589 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.777957 [debug] [Thread-1 (]: Timing info for snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot (execute): 14:55:12.596737 => 14:55:12.777697
[0m14:55:12.778458 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m14:55:12.779390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2984307d-166c-45ed-b5e5-762472b88ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986cc3850>]}
[0m14:55:12.780252 [info ] [Thread-1 (]: 8 of 8 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot .. [[32mSUCCESS 0[0m in 0.19s]
[0m14:55:12.781005 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m14:55:12.783019 [debug] [MainThread]: Using mysql connection "master"
[0m14:55:12.783455 [debug] [MainThread]: On master: BEGIN
[0m14:55:12.783795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:12.789690 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.790225 [debug] [MainThread]: On master: COMMIT
[0m14:55:12.790636 [debug] [MainThread]: Using mysql connection "master"
[0m14:55:12.791015 [debug] [MainThread]: On master: COMMIT
[0m14:55:12.791928 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:55:12.792371 [debug] [MainThread]: On master: Close
[0m14:55:12.793377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:12.793743 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m14:55:12.794185 [info ] [MainThread]: 
[0m14:55:12.794709 [info ] [MainThread]: Finished running 2 view models, 1 seed, 1 table model, 3 tests, 1 snapshot in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m14:55:12.796690 [debug] [MainThread]: Command end result
[0m14:55:12.808289 [info ] [MainThread]: 
[0m14:55:12.808839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:12.809352 [info ] [MainThread]: 
[0m14:55:12.809786 [error] [MainThread]:   Database Error in model int_revenue_by_date (models/intermediate/int_revenue_by_date.sql)
  1146 (42S02): Table 'public.stg_payment' doesn't exist
  compiled Code at target/run/test_dbt_project/models/intermediate/int_revenue_by_date.sql
[0m14:55:12.810250 [info ] [MainThread]: 
[0m14:55:12.810715 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m14:55:12.811755 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.7393084, "process_user_time": 6.818536, "process_kernel_time": 0.190876, "process_mem_max_rss": "126800", "process_out_blocks": "3248", "command_success": false, "process_in_blocks": "0"}
[0m14:55:12.812343 [debug] [MainThread]: Command `dbt build` failed at 14:55:12.812202 after 4.74 seconds
[0m14:55:12.812775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997af15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1986fe9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1994a61690>]}
[0m14:55:12.813166 [debug] [MainThread]: Flushing usage events
[0m14:56:23.535972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a38e7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1da3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1da3280>]}


============================== 14:56:23.539254 | fed49739-28cb-4a6b-94be-50c1aad530aa ==============================
[0m14:56:23.539254 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:56:23.539788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/src/dbt/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:56:23.653060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed49739-28cb-4a6b-94be-50c1aad530aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a4083d90>]}
[0m14:56:23.664726 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jdk7a1u2'
[0m14:56:23.665413 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:56:23.733803 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:56:23.734733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:56:23.802746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:56:23.810632 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:56:24.125337 [info ] [MainThread]: Installed from version 1.0.0
[0m14:56:24.125849 [info ] [MainThread]: Updated version available: 1.2.0
[0m14:56:24.126398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fed49739-28cb-4a6b-94be-50c1aad530aa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1e0d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1e0d8d0>]}
[0m14:56:24.126797 [info ] [MainThread]: 
[0m14:56:24.127186 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:56:24.128376 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6443717, "process_user_time": 2.731192, "process_kernel_time": 0.161928, "process_mem_max_rss": "92120", "process_out_blocks": "2184", "process_in_blocks": "0"}
[0m14:56:24.128952 [debug] [MainThread]: Command `dbt deps` succeeded at 14:56:24.128827 after 0.64 seconds
[0m14:56:24.129358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a38e7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1e0d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1a1e0f700>]}
[0m14:56:24.129751 [debug] [MainThread]: Flushing usage events
[0m14:56:27.127822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e426711b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e40b32800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e40b32140>]}


============================== 14:56:27.130588 | 8defc4ab-f3fa-44cd-bc3a-884c69b34255 ==============================
[0m14:56:27.130588 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:56:27.131143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/src/dbt/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --profiles-dir profiles', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:27.281313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8defc4ab-f3fa-44cd-bc3a-884c69b34255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f90fc70>]}
[0m14:56:27.352887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8defc4ab-f3fa-44cd-bc3a-884c69b34255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f91e830>]}
[0m14:56:27.353714 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:56:27.369099 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:56:27.404314 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:56:27.404975 [debug] [MainThread]: Partial parsing: deleted file: test_dbt_project://models/intermediate/int_revenue_by_date.sql
[0m14:56:27.615262 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_revenue_by_date' in the 'models' section of file 'models/intermediate/_intermediate_models.yml'
[0m14:56:27.617782 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.test_dbt_project.cumulative_revenue' (models/marts/cumulative_revenue.sql) depends on a node named 'int_revenue_by_date' which was not found
[0m14:56:27.618972 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.5412176, "process_user_time": 2.825037, "process_kernel_time": 0.162982, "process_mem_max_rss": "104076", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:56:27.619647 [debug] [MainThread]: Command `dbt build` failed at 14:56:27.619496 after 0.54 seconds
[0m14:56:27.620041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e426711b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f5b7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f5b7970>]}
[0m14:56:27.620488 [debug] [MainThread]: Flushing usage events
